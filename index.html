<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新东方前途出国重庆亚英院校查询系统 (AI增强管理版)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js';
    </script>
    <style>
        :root {
            --m-green: #B2F2BB; 
            --m-green-dark: #51CF66;
            --primary: #40C057;
            --bg: #F8FAF9;
            --white: #FFFFFF;
            --text-main: #2D3436;
            --border: #E9ECEF;
            --qs-gold: #FFD93D;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif; }
        body { background: var(--bg); color: var(--text-main); }

        /* --- 导航与布局 --- */
        nav { background: white; padding: 12px 40px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.02); }
        .mode-btn { padding: 8px 18px; border-radius: 50px; border: 1px solid var(--m-green-dark); cursor: pointer; font-size: 13px; background: none; color: var(--m-green-dark); font-weight: bold; transition: 0.3s; }
        .mode-btn.active { background: var(--m-green-dark); color: white; }

        /* --- 管理员布局 --- */
        .admin-layout { display: grid; grid-template-columns: 240px 1fr; height: calc(100vh - 60px); }
        .admin-sidebar { background: #2D3436; color: white; padding: 20px; }
        .admin-sidebar li { padding: 14px 18px; border-radius: 12px; cursor: pointer; margin-bottom: 8px; font-size: 14px; list-style: none; transition: 0.2s; }
        .admin-sidebar li:hover, .admin-sidebar li.active { background: var(--m-green-dark); }
        .admin-main { padding: 35px; overflow-y: auto; background: #F8FAF9; }

        /* --- 首页与搜索 --- */
        .header-section { padding: 45px 20px; text-align: center; background: white; border-bottom: 1px solid var(--border); }
        .art-title { font-size: 34px; font-weight: 900; background: linear-gradient(135deg, #74EBD5 0%, #9BE15D 100%); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 25px; }
        .search-container { max-width: 600px; margin: 0 auto; position: relative; }
        .search-input { width: 100%; padding: 14px 25px; border-radius: 50px; border: 2px solid var(--m-green); outline: none; transition: 0.3s; }
        .search-input:focus { border-color: var(--m-green-dark); box-shadow: 0 0 15px rgba(81, 207, 102, 0.2); }

        /* --- 院校卡片 --- */
        .uni-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; max-width: 1200px; margin: 35px auto; padding: 0 20px; }
        .uni-card { background: var(--white); border-radius: 20px; padding: 28px; border-bottom: 6px solid var(--m-green); transition: 0.3s; cursor: pointer; position: relative; box-shadow: 0 4px 6px rgba(0,0,0,0.02); }
        .uni-card:hover { transform: translateY(-6px); box-shadow: 0 15px 30px rgba(0,0,0,0.08); }

        /* --- OCR 与 表单 --- */
        .ocr-zone { border: 2px dashed #CBD5E0; border-radius: 15px; padding: 30px; text-align: center; background: #F7FAFC; cursor: pointer; margin-bottom: 20px; }
        .ocr-zone:hover { border-color: var(--m-green-dark); background: #F0FFF4; }
        .form-card { background: white; padding: 25px; border-radius: 18px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .form-group { margin-bottom: 18px; }
        .form-group label { display: block; margin-bottom: 6px; font-weight: bold; font-size: 13px; color: #4A5568; }
        .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 12px; border: 1px solid #E2E8F0; border-radius: 10px; font-size: 14px; }

        /* --- 列表层 --- */
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 2000; flex-direction: column; }
        .faculty-tabs { display: flex; gap: 12px; padding: 15px 40px; background: #F8FAF9; overflow-x: auto; border-bottom: 1px solid #EEE; }
        .fac-tab { padding: 10px 24px; border-radius: 50px; background: white; border: 1px solid #DDD; cursor: pointer; white-space: nowrap; font-size: 14px; }
        .fac-tab.active { background: var(--m-green-dark); color: white; border-color: var(--m-green-dark); }

        /* --- 详情弹窗 --- */
        #detailModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 3000; justify-content: center; align-items: flex-end; }
        #uniDetailModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 3000; justify-content: center; align-items: flex-end; }
        .modal-body { background: white; width: 100%; max-width: 1000px; height: 92vh; border-radius: 30px 30px 0 0; padding: 45px; overflow-y: auto; position: relative; }
        .content-box { background: #F8FAF9; padding: 22px; border-radius: 16px; white-space: pre-wrap; margin-top: 12px; line-height: 1.8; font-size: 14px; }

        table { width: 100%; border-collapse: collapse; background: white; border-radius: 12px; overflow: hidden; }
        th { background: #F7FAFC; padding: 16px; text-align: left; font-size: 13px; color: #718096; border-bottom: 2px solid var(--m-green); }
        td { padding: 18px 16px; border-bottom: 1px solid #EDF2F7; font-size: 14px; }

        .uni-info-section { background: white; padding: 35px 20px; border-bottom: 1px solid var(--border); }
        .uni-info-title { font-size: 22px; font-weight: bold; color: var(--text-main); margin-bottom: 25px; text-align: center; }
        .region-section { margin-bottom: 35px; }
        .region-title { font-size: 18px; font-weight: bold; color: var(--m-green-dark); margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid var(--m-green); }
        .uni-info-table { width: 100%; border-collapse: collapse; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .uni-info-table th { background: linear-gradient(135deg, var(--m-green) 0%, var(--m-green-dark) 100%); color: white; padding: 14px 16px; text-align: left; font-size: 13px; font-weight: bold; }
        .uni-info-table td { padding: 14px 16px; border-bottom: 1px solid #EDF2F7; font-size: 13px; }
        .uni-info-table tr:hover { background: #F0FFF4; }
        .uni-info-table tr { cursor: pointer; }
        .uni-info-table .qs-rank { font-weight: bold; color: var(--m-green-dark); }
        .uni-info-table .no-rank { color: #A0AEC0; }

        .faculty-tabs { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 10px; }
        .faculty-tab { padding: 10px 20px; border-radius: 25px; background: white; border: 1px solid #E2E8F0; cursor: pointer; white-space: nowrap; font-size: 14px; color: #4A5568; transition: all 0.3s; }
        .faculty-tab:hover { background: #F0FFF4; border-color: var(--m-green-dark); }
        .faculty-tab.active { background: var(--m-green-dark); color: white; border-color: var(--m-green-dark); }
        
        .majors-table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; margin-top: 15px; }
        .majors-table th { background: linear-gradient(135deg, var(--m-green) 0%, var(--m-green-dark) 100%); color: white; padding: 14px 16px; text-align: left; font-size: 13px; font-weight: bold; }
        .majors-table td { padding: 14px 16px; border-bottom: 1px solid #EDF2F7; font-size: 13px; }
        .majors-table tr:hover { background: #F0FFF4; }
        .majors-table tr:last-child td { border-bottom: none; }
        
        .info-card { background: white; padding: 20px; border-radius: 12px; border: 1px solid #E2E8F0; box-shadow: 0 2px 8px rgba(0,0,0,0.04); transition: all 0.3s; }
        .info-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-color: var(--m-green-dark); }
    </style>
</head>
<body>

    <nav>
        <div style="font-weight: 900; color: var(--m-green-dark); font-size: 18px;"><i class="fas fa-leaf"></i> 重庆亚英 · 智能查校系统</div>
        <button id="modeSwitch" class="mode-btn" onclick="toggleView()">切换至管理后台</button>
    </nav>

    <div id="view-user">
        <div class="header-section">
            <h1 class="art-title">院校专业数据库</h1>
            <div class="search-container">
                <input type="text" id="gInput" class="search-input" placeholder="输入专业关键词进行全库搜索...">
                <button onclick="globalSearch()" style="position:absolute; right:10px; top:8px; padding:9px 28px; border-radius:40px; border:none; background:var(--m-green-dark); color:white; cursor:pointer; font-weight:bold;">搜索</button>
            </div>
        </div>

        <div class="uni-info-section">
            <div class="uni-info-title">香港、澳门、新加坡及中外合办大学信息整理</div>

            <div class="region-section">
                <div class="region-title">香港地区</div>
                <table class="uni-info-table">
                    <thead>
                        <tr>
                            <th width="20%">大学名称</th>
                            <th width="25%">英文名称</th>
                            <th width="25%">地点</th>
                            <th width="15%">QS排名</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr onclick="showUniDetail('香港大学')"><td>香港大学</td><td>The University of Hong Kong</td><td>中国｜香港｜香港岛</td><td class="qs-rank">11</td></tr>
                        <tr onclick="showUniDetail('香港中文大学')"><td>香港中文大学</td><td>The Chinese University of Hong Kong</td><td>中国｜香港｜新界</td><td class="qs-rank">32</td></tr>
                        <tr onclick="showUniDetail('香港科技大学')"><td>香港科技大学</td><td>The Hong Kong University of Science and Technology</td><td>中国｜香港｜九龙</td><td class="qs-rank">44</td></tr>
                        <tr onclick="showUniDetail('香港理工大学')"><td>香港理工大学</td><td>The Hong Kong Polytechnic University</td><td>中国｜香港｜九龙</td><td class="qs-rank">54</td></tr>
                        <tr onclick="showUniDetail('香港城市大学')"><td>香港城市大学</td><td>City University of Hong Kong</td><td>中国｜香港｜九龙</td><td class="qs-rank">63</td></tr>
                        <tr onclick="showUniDetail('香港浸会大学')"><td>香港浸会大学</td><td>Hong Kong Baptist University</td><td>中国｜香港｜九龙</td><td class="qs-rank">244</td></tr>
                        <tr onclick="showUniDetail('岭南大学')"><td>岭南大学</td><td>Lingnan University</td><td>中国｜香港｜新界</td><td class="qs-rank">701-710</td></tr>
                        <tr onclick="showUniDetail('香港都会大学')"><td>香港都会大学</td><td>Hong Kong Metropolitan University</td><td>中国｜香港｜九龙</td><td class="qs-rank">781-790</td></tr>
                        <tr onclick="showUniDetail('香港树仁大学')"><td>香港树仁大学</td><td>Hong Kong Shue Yan University</td><td>中国｜香港｜香港岛</td><td class="no-rank">暂无</td></tr>
                        <tr onclick="showUniDetail('香港恒生大学')"><td>香港恒生大学</td><td>The Hang Seng University of Hong Kong</td><td>中国｜香港｜新界</td><td class="no-rank">暂无</td></tr>
                        <tr onclick="showUniDetail('香港珠海学院')"><td>香港珠海学院</td><td>Hong Kong Chu Hai College</td><td>中国｜香港｜新界</td><td class="no-rank">暂无</td></tr>
                        <tr onclick="showUniDetail('香港高等教育科技学院')"><td>香港高等教育科技学院</td><td>Technological and Higher Education Institute of Hong Kong</td><td>中国｜香港｜香港岛</td><td class="no-rank">暂无</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="region-section">
                <div class="region-title">新加坡地区</div>
                <table class="uni-info-table">
                    <thead>
                        <tr>
                            <th width="20%">大学名称</th>
                            <th width="25%">英文名称</th>
                            <th width="25%">地点</th>
                            <th width="15%">QS排名</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr onclick="showUniDetail('新加坡国立大学')"><td>新加坡国立大学</td><td>National University of Singapore</td><td>新加坡</td><td class="qs-rank">8</td></tr>
                        <tr onclick="showUniDetail('南洋理工大学')"><td>南洋理工大学</td><td>Nanyang Technological University</td><td>新加坡</td><td class="qs-rank">12</td></tr>
                        <tr onclick="showUniDetail('新加坡管理大学')"><td>新加坡管理大学</td><td>Singapore Management University</td><td>新加坡</td><td class="qs-rank">511</td></tr>
                        <tr onclick="showUniDetail('新加坡科技设计大学')"><td>新加坡科技设计大学</td><td>Singapore University of Technology and Design</td><td>新加坡</td><td class="qs-rank">519</td></tr>
                        <tr onclick="showUniDetail('新加坡理工大学')"><td>新加坡理工大学</td><td>Singapore Institute of Technology</td><td>新加坡</td><td class="no-rank">暂无</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="region-section">
                <div class="region-title">澳门地区</div>
                <table class="uni-info-table">
                    <thead>
                        <tr>
                            <th width="20%">大学名称</th>
                            <th width="25%">英文名称</th>
                            <th width="25%">地点</th>
                            <th width="15%">QS排名</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr onclick="showUniDetail('澳门大学')"><td>澳门大学</td><td>University of Macau</td><td>中国｜澳门｜凼仔</td><td class="qs-rank">285</td></tr>
                        <tr onclick="showUniDetail('澳门科技大学')"><td>澳门科技大学</td><td>Macau University of Science and Technology</td><td>中国｜澳门｜凼仔</td><td class="qs-rank">440</td></tr>
                        <tr onclick="showUniDetail('澳门理工大学')"><td>澳门理工大学</td><td>Macao Polytechnic University</td><td>中国｜澳门｜高美士街</td><td class="qs-rank">901-950</td></tr>
                        <tr onclick="showUniDetail('澳门城市大学')"><td>澳门城市大学</td><td>City University of Macau</td><td>中国｜澳门｜凼仔</td><td class="no-rank">暂无</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="region-section" style="margin-bottom: 0;">
                <div class="region-title">中外合办大学</div>
                <table class="uni-info-table">
                    <thead>
                        <tr>
                            <th width="20%">大学名称</th>
                            <th width="25%">英文名称</th>
                            <th width="25%">地点</th>
                            <th width="15%">QS排名</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr onclick="showUniDetail('西交利物浦大学')"><td>西交利物浦大学</td><td>Xi'an Jiaotong-Liverpool University (XJTLU)</td><td>中国｜江苏｜苏州</td><td class="no-rank">暂无</td></tr>
                        <tr onclick="showUniDetail('宁波诺丁汉大学')"><td>宁波诺丁汉大学</td><td>University of Nottingham Ningbo China</td><td>中国｜浙江｜宁波</td><td class="no-rank">暂无</td></tr>
                        <tr onclick="showUniDetail('香港中文大学（深圳）')"><td>香港中文大学（深圳）</td><td>The Chinese University of Hong Kong (Shenzhen)</td><td>中国｜广东｜深圳</td><td class="no-rank">暂无</td></tr>
                        <tr onclick="showUniDetail('香港科技大学（广州）')"><td>香港科技大学（广州）</td><td>The Hong Kong University of Science and Technology (Guangzhou)</td><td>中国｜广东｜广州</td><td class="no-rank">暂无</td></tr>
                        <tr onclick="showUniDetail('香港城市大学（东莞）')"><td>香港城市大学（东莞）</td><td>City University of Hong Kong (Dongguan)</td><td>中国｜广东｜东莞</td><td class="no-rank">暂无</td></tr>
                        <tr onclick="showUniDetail('北师香港浸会大学')"><td>北师香港浸会大学</td><td>Beijing Normal-Hong Kong Baptist University</td><td>中国｜广东｜珠海</td><td class="no-rank">暂无</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="uni-grid" id="uniGrid"></div>
    </div>

    <div id="view-admin" style="display: none;">
        <div class="admin-layout">
            <div class="admin-sidebar">
                <div style="padding: 10px 18px 30px; font-weight: bold; color: var(--m-green);">ADMIN PANEL</div>
                <li onclick="switchAdminNav('data')" id="nav-data" class="active"><i class="fas fa-plus-circle"></i> 智能录入</li>
                <li onclick="switchAdminNav('manage')" id="nav-manage"><i class="fas fa-edit"></i> 数据管理</li>
                <li onclick="switchAdminNav('crawler')" id="nav-crawler"><i class="fas fa-spider"></i> 监测中心</li>
                <li onclick="switchAdminNav('audit')" id="nav-audit"><i class="fas fa-shield-alt"></i> 安全审计</li>
            </div>
            <div class="admin-main" id="adminBody">
                </div>
        </div>
    </div>

    <div id="listOverlay" class="overlay">
        <div style="padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #EEE;">
            <h2 id="lTitle" style="color: var(--m-green-dark);">专业清单</h2>
            <button onclick="closeOverlay()" style="border:none; background:#F1F3F5; padding:8px 25px; border-radius:50px; cursor:pointer;">返回</button>
        </div>
        <div class="faculty-tabs" id="facTabs"></div>
        <div id="lContent" style="padding: 25px 40px; overflow-y: auto;"></div>
    </div>

    <div id="detailModal">
        <div class="modal-body">
            <i class="fas fa-times" style="position:absolute; top:35px; right:40px; cursor:pointer; font-size:22px; color:#CBD5E0;" onclick="closeDetail()"></i>
            <span id="d_tag" style="color:var(--m-green-dark); font-weight:bold; font-size:13px; text-transform:uppercase; letter-spacing:1px;"></span>
            <h1 id="d_cn" style="font-size:30px; margin: 12px 0 6px;"></h1>
            <p id="d_en" style="color:#A0AEC0; font-size:18px; margin-bottom:30px;"></p>
            <div id="d_info" style="display:flex; gap:12px;"></div>
            
            <div style="font-weight:bold; margin-top:35px; color:var(--primary);">申请要求 (Admission)</div>
            <div class="content-box" id="d_req" style="background:#FFFBEB; border:1px solid #FEF3C7; color:#92400E;"></div>
            
            <div style="font-weight:bold; margin-top:30px; color:var(--primary);">课程结构 (Curriculum)</div>
            <div class="content-box" id="d_struct"></div>
        </div>
    </div>

    <div id="uniDetailOverlay" class="overlay">
        <div style="padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #EEE;">
            <h2 id="udTitle" style="color: var(--m-green-dark);">大学详情</h2>
            <button onclick="closeUniDetail()" style="border:none; background:#F1F3F5; padding:8px 25px; border-radius:50px; cursor:pointer;">返回</button>
        </div>
        <div style="padding: 25px 40px; overflow-y: auto; flex: 1;">
            <span id="ud_tag" style="color:var(--m-green-dark); font-weight:bold; font-size:13px; text-transform:uppercase; letter-spacing:1px;">大学详情</span>
            <h1 id="ud_cn" style="font-size:30px; margin: 12px 0 6px;"></h1>
            <p id="ud_en" style="color:#A0AEC0; font-size:18px; margin-bottom:30px;"></p>
            <div id="ud_info" style="display:flex; gap:12px; flex-wrap:wrap;"></div>
            
            <div style="font-weight:bold; margin-top:35px; color:var(--primary);">学校简介</div>
            <div class="content-box" id="ud_desc"></div>
            
            <div style="font-weight:bold; margin-top:35px; color:var(--primary);">学院与硕士专业</div>
            <div id="ud_faculties" style="margin-top:15px;"></div>
        </div>
    </div>

    <div id="majorDetailOverlay" class="overlay">
        <div style="padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #EEE;">
            <h2 style="color: var(--m-green-dark);">专业详情</h2>
            <button onclick="closeMajorDetail()" style="border:none; background:#F1F3F5; padding:8px 25px; border-radius:50px; cursor:pointer;">返回</button>
        </div>
        <div style="padding: 25px 40px; overflow-y: auto; flex: 1;">
            <span style="color:var(--m-green-dark); font-weight:bold; font-size:13px; text-transform:uppercase; letter-spacing:1px;">专业详情</span>
            <h1 id="md_cn" style="font-size:30px; margin: 12px 0 6px;"></h1>
            <p id="md_en" style="color:#A0AEC0; font-size:18px; margin-bottom:20px;"></p>
            
            <div style="display:flex; gap:10px; margin-bottom:30px; flex-wrap:wrap;">
                <span id="md_school" style="background:#F0FFF4; padding:6px 16px; border-radius:50px; font-size:12px; font-weight:bold; color:var(--m-green-dark);"></span>
                <span id="md_faculty" style="background:#E6FFFA; padding:6px 16px; border-radius:50px; font-size:12px; font-weight:bold; color:#38B2AC;"></span>
            </div>
            
            <div style="font-weight:bold; margin-bottom:15px; color:var(--primary);">基本信息</div>
            <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:15px; margin-bottom:30px;">
                <div class="info-card">
                    <div style="color:#718096; font-size:12px; margin-bottom:8px;">学制</div>
                    <div id="md_duration" style="font-size:18px; font-weight:bold; color:#2D3436;"></div>
                </div>
                <div class="info-card">
                    <div style="color:#718096; font-size:12px; margin-bottom:8px;">学费金额</div>
                    <div id="md_fee_amount" style="font-size:18px; font-weight:bold; color:var(--m-green-dark);"></div>
                </div>
                <div class="info-card">
                    <div style="color:#718096; font-size:12px; margin-bottom:8px;">申请截止时间</div>
                    <div id="md_deadline" style="font-size:18px; font-weight:bold; color:#2D3436;"></div>
                </div>
            </div>
            
            <div style="font-weight:bold; margin-bottom:15px; color:var(--primary);">语言要求</div>
            <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:15px; margin-bottom:30px;">
                <div class="info-card">
                    <div style="color:#718096; font-size:12px; margin-bottom:8px;">雅思要求</div>
                    <div id="md_ielts" style="font-size:18px; font-weight:bold; color:#2D3436;"></div>
                </div>
                <div class="info-card">
                    <div style="color:#718096; font-size:12px; margin-bottom:8px;">托福要求</div>
                    <div id="md_toefl" style="font-size:18px; font-weight:bold; color:#2D3436;"></div>
                </div>
                <div class="info-card">
                    <div style="color:#718096; font-size:12px; margin-bottom:8px;">GRE/GMAT</div>
                    <div id="md_gre" style="font-size:18px; font-weight:bold; color:#2D3436;"></div>
                </div>
            </div>
            
            <div style="font-weight:bold; margin-bottom:15px; color:var(--primary);">专业概况</div>
            <div class="content-box" id="md_overview" style="background:#FFFBEB; border:1px solid #FEF3C7; color:#92400E; margin-bottom:30px;"></div>
            
            <div style="font-weight:bold; margin-bottom:15px; color:var(--primary);">课程结构</div>
            <div class="content-box" id="md_curriculum" style="background:#E6FFFA; border:1px solid #B2F5EA; color:#285E61; margin-bottom:30px;"></div>
            
            <div style="font-weight:bold; margin-bottom:15px; color:var(--primary);">学术要求</div>
            <div class="content-box" id="md_academic" style="background:#F0FFF4; border:1px solid #C6F6D5; color:#22543D; margin-bottom:30px;"></div>
            
            <div style="display:flex; gap:15px; margin-top:30px;">
                <a id="md_url" href="#" target="_blank" style="display:inline-flex; align-items:center; gap:8px; padding:14px 35px; background:var(--m-green-dark); color:white; border:none; border-radius:25px; cursor:pointer; font-size:15px; font-weight:bold; text-decoration:none;">
                    <i class="fas fa-external-link-alt"></i> 访问专业官网
                </a>
                <a id="md_req_url" href="#" target="_blank" style="display:inline-flex; align-items:center; gap:8px; padding:14px 35px; background:white; color:var(--m-green-dark); border:2px solid var(--m-green-dark); border-radius:25px; cursor:pointer; font-size:15px; font-weight:bold; text-decoration:none;">
                    <i class="fas fa-file-alt"></i> 查看申请要求
                </a>
            </div>
        </div>
    </div>

    <script>
        // --- 核心数据存储 ---
        let uniList = JSON.parse(localStorage.getItem('yaying_unis')) || [];

        const uniDetails = {
            "香港大学": { en: "The University of Hong Kong", location: "中国｜香港｜香港岛", qs: "11", desc: "香港大学是香港历史最悠久的高等学府，成立于1911年，是亚洲顶尖的研究型大学之一。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "2025-03-15", fee: "HK$ 580,000", language: "IELTS 6.5", gre: "建议", url: "https://www.fbe.hku.hk/mba", duration: "1年", toefl: "TOEFL 80", overview: "香港大学MBA项目是亚洲领先的商学教育项目，培养具有全球视野和领导力的商业精英。课程涵盖战略管理、财务分析、市场营销、组织行为等核心领域，注重实践应用和案例分析。", curriculum: "核心课程：战略管理、财务管理、市场营销、组织行为学、运营管理\n选修课程：国际商务、创业管理、金融工程、数据分析等\n实践项目：商业咨询项目、领导力发展计划、企业参访", academic: "本科学位，GPA 3.0/4.0以上，至少3年全职工作经验，GMAT/GRE成绩（建议GMAT 600+），两封推荐信，个人陈述，面试。", req_url: "https://www.fbe.hku.hk/mba/admissions" },
                    { cn: "金融学硕士", en: "Master of Finance", deadline: "2025-02-28", fee: "HK$ 420,000", language: "IELTS 7.0", gre: "不要求", url: "https://www.fbe.hku.hk/mfin" },
                    { cn: "会计学硕士", en: "Master of Accounting", deadline: "2025-03-31", fee: "HK$ 360,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.fbe.hku.hk/macct" },
                    { cn: "市场营销硕士", en: "Master of Marketing", deadline: "2025-03-15", fee: "HK$ 330,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.fbe.hku.hk/mkt" },
                    { cn: "商业分析硕士", en: "Master of Business Analytics", deadline: "2025-02-28", fee: "HK$ 390,000", language: "IELTS 6.5", gre: "建议", url: "https://www.fbe.hku.hk/mba" }
                ]},
                { name: "工程学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "2025-03-15", fee: "HK$ 216,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.cs.hku.hk/" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.eee.hku.hk/" },
                    { cn: "机械工程硕士", en: "MSc in Mechanical Engineering", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.mech.hku.hk/" },
                    { cn: "土木工程硕士", en: "MSc in Civil Engineering", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.civil.hku.hk/" },
                    { cn: "工业工程硕士", en: "MSc in Industrial Engineering", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ie.hku.hk/" }
                ]},
                { name: "医学院", majors: [
                    { cn: "公共卫生硕士", en: "Master of Public Health", deadline: "2025-04-30", fee: "HK$ 300,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hku.hk/sph/" },
                    { cn: "护理学硕士", en: "Master of Nursing", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hku.hk/nursing/" },
                    { cn: "医学硕士", en: "Master of Medical Sciences", deadline: "2025-03-15", fee: "HK$ 360,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hku.hk/med/" },
                    { cn: "中医学硕士", en: "Master of Chinese Medicine", deadline: "2025-03-31", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hku.hk/cmc/" }
                ]},
                { name: "社会科学学院", majors: [
                    { cn: "心理学硕士", en: "Master of Psychology", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hku.hk/psych/" },
                    { cn: "社会学硕士", en: "Master of Sociology", deadline: "2025-03-15", fee: "HK$ 168,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hku.hk/soci/" },
                    { cn: "政治学硕士", en: "Master of Political Science", deadline: "2025-03-15", fee: "HK$ 168,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hku.hk/pol/" },
                    { cn: "经济学硕士", en: "Master of Economics", deadline: "2025-03-15", fee: "HK$ 216,000", language: "IELTS 6.5", gre: "建议", url: "https://www.hku.hk/econ/" }
                ]}
            ]},
            "香港中文大学": { en: "The Chinese University of Hong Kong", location: "中国｜香港｜新界", qs: "32", desc: "香港中文大学成立于1963年，是香港第二所大学，以其独特的书院制教育体系闻名。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "2025-03-15", fee: "HK$ 520,000", language: "IELTS 6.5", gre: "建议", url: "https://www.bschool.cuhk.edu.hk/mba" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "2025-02-28", fee: "HK$ 390,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.bschool.cuhk.edu.hk/mscf" },
                    { cn: "会计学硕士", en: "MSc in Accountancy", deadline: "2025-03-31", fee: "HK$ 330,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.bschool.cuhk.edu.hk/msca" },
                    { cn: "市场学硕士", en: "MSc in Marketing", deadline: "2025-03-15", fee: "HK$ 300,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.bschool.cuhk.edu.hk/mscmkt" }
                ]},
                { name: "工程学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.cse.cuhk.edu.hk/" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "2025-03-15", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ee.cuhk.edu.hk/" },
                    { cn: "系统工程硕士", en: "MSc in Systems Engineering", deadline: "2025-03-15", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.se.cuhk.edu.hk/" },
                    { cn: "信息工程硕士", en: "MSc in Information Engineering", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ie.cuhk.edu.hk/" }
                ]},
                { name: "医学院", majors: [
                    { cn: "公共卫生硕士", en: "Master of Public Health", deadline: "2025-04-30", fee: "HK$ 270,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cuhk.edu.hk/med/" },
                    { cn: "护理学硕士", en: "Master of Nursing", deadline: "2025-03-31", fee: "HK$ 210,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cuhk.edu.hk/nursing/" },
                    { cn: "中医学硕士", en: "Master of Chinese Medicine", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.cuhk.edu.hk/cmc/" },
                    { cn: "医学硕士", en: "Master of Medical Sciences", deadline: "2025-03-15", fee: "HK$ 330,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cuhk.edu.hk/med/" }
                ]},
                { name: "文学院", majors: [
                    { cn: "中国文学硕士", en: "MA in Chinese Literature", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cuhk.edu.hk/arts/" },
                    { cn: "英语文学硕士", en: "MA in English Literary Studies", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cuhk.edu.hk/eng/" },
                    { cn: "语言学硕士", en: "MA in Linguistics", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cuhk.edu.hk/ling/" },
                    { cn: "翻译硕士", en: "MA in Translation", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cuhk.edu.hk/tran/" }
                ]}
            ]},
            "香港科技大学": { en: "The Hong Kong University of Science and Technology", location: "中国｜香港｜九龙", qs: "44", desc: "香港科技大学成立于1991年，是一所研究型大学，在工程、商业和科学领域享有盛誉。", faculties: [
                { name: "工学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "2025-03-15", fee: "HK$ 210,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cse.ust.hk/" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.ee.ust.hk/" },
                    { cn: "机械工程硕士", en: "MSc in Mechanical Engineering", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.me.ust.hk/" },
                    { cn: "化学工程硕士", en: "MSc in Chemical Engineering", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.chemeng.ust.hk/" },
                    { cn: "土木工程硕士", en: "MSc in Civil Engineering", deadline: "2025-03-15", fee: "HK$ 180,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.civil.ust.hk/" }
                ]},
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "2025-03-15", fee: "HK$ 560,000", language: "IELTS 7.0", gre: "建议", url: "https://www.bm.ust.hk/mba" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "2025-02-28", fee: "HK$ 420,000", language: "IELTS 7.0", gre: "建议", url: "https://www.bm.ust.hk/mscf" },
                    { cn: "商业分析硕士", en: "MSc in Business Analytics", deadline: "2025-02-28", fee: "HK$ 360,000", language: "IELTS 6.5", gre: "建议", url: "https://www.bm.ust.hk/mscba" },
                    { cn: "信息系统管理硕士", en: "MSc in Information Systems Management", deadline: "2025-03-15", fee: "HK$ 330,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.bm.ust.hk/mscism" }
                ]},
                { name: "理学院", majors: [
                    { cn: "数学硕士", en: "MSc in Mathematics", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.math.ust.hk/" },
                    { cn: "物理学硕士", en: "MSc in Physics", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.phys.ust.hk/" },
                    { cn: "化学硕士", en: "MSc in Chemistry", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.chem.ust.hk/" },
                    { cn: "生物技术硕士", en: "MSc in Biotechnology", deadline: "2025-03-15", fee: "HK$ 168,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.bio.ust.hk/" }
                ]},
                { name: "人文社会科学学院", majors: [
                    { cn: "社会科学硕士", en: "MA in Social Science", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.shss.ust.hk/" },
                    { cn: "中国文化硕士", en: "MA in Chinese Culture", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.shss.ust.hk/" },
                    { cn: "全球研究硕士", en: "MSc in Global China Studies", deadline: "2025-03-15", fee: "HK$ 144,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.shss.ust.hk/" }
                ]}
            ]},
            "香港理工大学": { en: "The Hong Kong Polytechnic University", location: "中国｜香港｜九龙", qs: "54", desc: "香港理工大学成立于1937年，是一所应用型大学，注重实践和专业教育。", faculties: [
                { name: "工商管理学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "2025-03-31", fee: "HK$ 480,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/sbm/mba" },
                    { cn: "会计学硕士", en: "Master of Accounting", deadline: "2025-03-31", fee: "HK$ 300,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/sbm/macct" },
                    { cn: "金融学硕士", en: "Master of Finance", deadline: "2025-03-31", fee: "HK$ 330,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/sbm/mfin" },
                    { cn: "物流管理硕士", en: "MSc in International Shipping and Transport Logistics", deadline: "2025-03-31", fee: "HK$ 270,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/sbm/mistl" }
                ]},
                { name: "工程学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "2025-03-31", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/comp/msc" },
                    { cn: "电子工程硕士", en: "MSc in Electronic and Information Engineering", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/eie/msc" },
                    { cn: "机械工程硕士", en: "MSc in Mechanical Engineering", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/me/msc" },
                    { cn: "工业系统工程硕士", en: "MSc in Industrial and Systems Engineering", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/ise/msc" }
                ]},
                { name: "建设及环境学院", majors: [
                    { cn: "建筑学硕士", en: "Master of Architecture", deadline: "2025-03-31", fee: "HK$ 210,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/ce/msc" },
                    { cn: "屋宇设备工程硕士", en: "MSc in Building Services Engineering", deadline: "2025-03-31", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/bs/msc" },
                    { cn: "土木工程硕士", en: "MSc in Civil Engineering", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/ce/msc" },
                    { cn: "测量学硕士", en: "MSc in Surveying", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/ls/msc" }
                ]},
                { name: "酒店及旅游业管理学院", majors: [
                    { cn: "酒店管理硕士", en: "MSc in International Hospitality Management", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/shtm/msc" },
                    { cn: "旅游管理硕士", en: "MSc in International Tourism and Convention Management", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/shtm/msc" },
                    { cn: "会展管理硕士", en: "MSc in International Convention and Event Management", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.polyu.edu.hk/shtm/msc" }
                ]}
            ]},
            "香港城市大学": { en: "City University of Hong Kong", location: "中国｜香港｜九龙", qs: "63", desc: "香港城市大学成立于1984年，是一所综合性研究型大学，以创新和专业教育著称。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "2025-03-31", fee: "HK$ 480,000", language: "IELTS 6.5", gre: "建议", url: "https://www.cb.cityu.edu.hk/mba" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "2025-03-31", fee: "HK$ 360,000", language: "IELTS 6.5", gre: "建议", url: "https://www.cb.cityu.edu.hk/mscf" },
                    { cn: "市场营销硕士", en: "MSc in Marketing", deadline: "2025-03-31", fee: "HK$ 330,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cb.cityu.edu.hk/mscmkt" },
                    { cn: "商业分析硕士", en: "MSc in Business Analytics", deadline: "2025-03-31", fee: "HK$ 360,000", language: "IELTS 6.5", gre: "建议", url: "https://www.cb.cityu.edu.hk/mscba" }
                ]},
                { name: "工学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "2025-03-31", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.cs.cityu.edu.hk/" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ee.cityu.edu.hk/" },
                    { cn: "机械工程硕士", en: "MSc in Mechanical Engineering", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.me.cityu.edu.hk/" },
                    { cn: "建筑学硕士", en: "Master of Architecture", deadline: "2025-03-31", fee: "HK$ 210,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.cityu.edu.hk/arch/" }
                ]},
                { name: "人文社会科学学院", majors: [
                    { cn: "心理学硕士", en: "MA in Psychology", deadline: "2025-03-31", fee: "HK$ 156,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cityu.edu.hk/psych/" },
                    { cn: "传播学硕士", en: "MA in Communication and New Media", deadline: "2025-03-31", fee: "HK$ 156,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cityu.edu.hk/com/" },
                    { cn: "社会工作硕士", en: "Master of Social Work", deadline: "2025-03-31", fee: "HK$ 156,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cityu.edu.hk/sw/" },
                    { cn: "公共政策硕士", en: "MSc in Public Policy and Management", deadline: "2025-03-31", fee: "HK$ 180,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.cityu.edu.hk/ppm/" }
                ]},
                { name: "理学院", majors: [
                    { cn: "应用物理学硕士", en: "MSc in Applied Physics", deadline: "2025-03-31", fee: "HK$ 144,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.cityu.edu.hk/phys/" },
                    { cn: "化学硕士", en: "MSc in Chemistry", deadline: "2025-03-31", fee: "HK$ 144,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.cityu.edu.hk/chem/" },
                    { cn: "数学硕士", en: "MSc in Applied Mathematics", deadline: "2025-03-31", fee: "HK$ 144,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.cityu.edu.hk/math/" },
                    { cn: "环境科学硕士", en: "MSc in Environmental Science", deadline: "2025-03-31", fee: "HK$ 156,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.cityu.edu.hk/env/" }
                ]}
            ]},
            "香港浸会大学": { en: "Hong Kong Baptist University", location: "中国｜香港｜九龙", qs: "244", desc: "香港浸会大学成立于1956年，是一所基督教背景的综合性大学，注重全人教育。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "2025-03-31", fee: "HK$ 420,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/sba/mba" },
                    { cn: "会计学硕士", en: "MSc in Applied Accounting and Finance", deadline: "2025-03-31", fee: "HK$ 270,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/sba/macaf" },
                    { cn: "应用经济学硕士", en: "MSc in Applied Economics", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/sba/mae" },
                    { cn: "人力资源管理硕士", en: "MSc in Human Resources Management", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/sba/mhrm" }
                ]},
                { name: "传理学院", majors: [
                    { cn: "传播学硕士", en: "MA in Communication", deadline: "2025-03-31", fee: "HK$ 210,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/com/ma" },
                    { cn: "新闻学硕士", en: "MA in International Journalism Studies", deadline: "2025-03-31", fee: "HK$ 210,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/com/maijs" },
                    { cn: "电影电视硕士", en: "MFA in Film, Television and Digital Media", deadline: "2025-03-31", fee: "HK$ 270,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/com/mfa" },
                    { cn: "广告学硕士", en: "MSc in Marketing and Digital Media", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/com/msmdm" }
                ]},
                { name: "中医药学院", majors: [
                    { cn: "中医学硕士", en: "Master of Chinese Medicine", deadline: "2025-03-31", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkbu.edu.hk/cmc/mcm" },
                    { cn: "中药学硕士", en: "MSc in Chinese Medicinal Pharmacy", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkbu.edu.hk/cmc/mscmp" },
                    { cn: "针灸学硕士", en: "MSc in Acupuncture and Moxibustion", deadline: "2025-03-31", fee: "HK$ 156,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkbu.edu.hk/cmc/msam" }
                ]},
                { name: "社会科学学院", majors: [
                    { cn: "社会工作硕士", en: "Master of Social Work", deadline: "2025-03-31", fee: "HK$ 180,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/sosc/msw" },
                    { cn: "心理学硕士", en: "MA in Psychology", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/sosc/map" },
                    { cn: "教育学硕士", en: "Master of Education", deadline: "2025-03-31", fee: "HK$ 156,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/ed/med" },
                    { cn: "辅导学硕士", en: "MA in Counselling", deadline: "2025-03-31", fee: "HK$ 156,000", language: "IELTS 6.5", gre: "不要求", url: "https://www.hkbu.edu.hk/sosc/mac" }
                ]}
            ]},
            "岭南大学": { en: "Lingnan University", location: "中国｜香港｜新界", qs: "701-710", desc: "岭南大学成立于1967年，是一所博雅大学，以人文社科教育为特色。", faculties: [
                { name: "文学院", majors: [
                    { cn: "中国文学硕士", en: "MA in Chinese", deadline: "2025-03-31", fee: "HK$ 132,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/arts/ma" },
                    { cn: "历史学硕士", en: "MA in History", deadline: "2025-03-31", fee: "HK$ 132,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/arts/mah" },
                    { cn: "哲学硕士", en: "MA in Philosophy", deadline: "2025-03-31", fee: "HK$ 132,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/arts/map" },
                    { cn: "翻译硕士", en: "MA in Translation", deadline: "2025-03-31", fee: "HK$ 132,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/arts/mat" }
                ]},
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "2025-03-31", fee: "HK$ 360,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/sbm/mba" },
                    { cn: "人力资源硕士", en: "MSc in Human Resource Management", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/sbm/mhrm" },
                    { cn: "市场学硕士", en: "MSc in Marketing and International Business", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/sbm/mmkib" },
                    { cn: "风险管理硕士", en: "MSc in Risk and Insurance Management", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/sbm/mrim" }
                ]},
                { name: "社会科学学院", majors: [
                    { cn: "国际事务硕士", en: "MA in International Affairs", deadline: "2025-03-31", fee: "HK$ 132,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/sosc/maia" },
                    { cn: "心理学硕士", en: "MA in Applied Psychology", deadline: "2025-03-31", fee: "HK$ 144,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/sosc/maap" },
                    { cn: "社会工作硕士", en: "Master of Social Work", deadline: "2025-03-31", fee: "HK$ 144,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/sosc/msw" },
                    { cn: "经济学硕士", en: "MSc in International Banking and Finance", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.ln.edu.hk/sosc/msibf" }
                ]}
            ]},
            "香港都会大学": { en: "Hong Kong Metropolitan University", location: "中国｜香港｜九龙", qs: "781-790", desc: "香港都会大学成立于1989年，是一所提供灵活学习模式的大学。", faculties: [
                { name: "李兆基商业管理学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "2025-03-31", fee: "HK$ 360,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/sba/mba" },
                    { cn: "会计学硕士", en: "MSc in Accounting", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/sba/macct" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "2025-03-31", fee: "HK$ 270,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/sba/mfin" },
                    { cn: "市场学硕士", en: "MSc in Marketing Management", deadline: "2025-03-31", fee: "HK$ 240,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/sba/mmm" }
                ]},
                { name: "科技学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "2025-03-31", fee: "HK$ 180,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/st/msc" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Commerce and Internet Computing", deadline: "2025-03-31", fee: "HK$ 168,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/st/msc" },
                    { cn: "应用科学硕士", en: "MSc in Applied Science", deadline: "2025-03-31", fee: "HK$ 156,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/st/msc" }
                ]},
                { name: "人文社会科学院", majors: [
                    { cn: "中国文学硕士", en: "MA in Chinese Literature", deadline: "2025-03-31", fee: "HK$ 132,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/ahs/ma" },
                    { cn: "翻译硕士", en: "MA in Translation and Bilingual Communication", deadline: "2025-03-31", fee: "HK$ 132,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/ahs/ma" },
                    { cn: "社会科学硕士", en: "MA in Social Sciences", deadline: "2025-03-31", fee: "HK$ 132,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/ahs/ma" },
                    { cn: "心理学硕士", en: "MA in Psychology", deadline: "2025-03-31", fee: "HK$ 144,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hkmu.edu.hk/ahs/ma" }
                ]}
            ]},
            "香港树仁大学": { en: "Hong Kong Shue Yan University", location: "中国｜香港｜香港岛", qs: "暂无", desc: "香港树仁大学成立于1971年，是香港第一所私立大学，以人文社科教育为主。", faculties: [
                { name: "文学院", majors: [
                    { cn: "中国文学硕士", en: "MA in Chinese Literature", deadline: "2025-03-31", fee: "HK$ 120,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hksyu.edu/arts/ma" },
                    { cn: "历史学硕士", en: "MA in History", deadline: "2025-03-31", fee: "HK$ 120,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hksyu.edu/arts/mah" },
                    { cn: "哲学硕士", en: "MA in Philosophy", deadline: "2025-03-31", fee: "HK$ 120,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hksyu.edu/arts/map" },
                    { cn: "新闻与传播硕士", en: "MA in Journalism and Communication", deadline: "2025-03-31", fee: "HK$ 132,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hksyu.edu/arts/majc" }
                ]},
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "2025-03-31", fee: "HK$ 300,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hksyu.edu/bba/mba" },
                    { cn: "市场学硕士", en: "MSc in Marketing", deadline: "2025-03-31", fee: "HK$ 216,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hksyu.edu/bba/msc" },
                    { cn: "会计学硕士", en: "MSc in Accounting", deadline: "2025-03-31", fee: "HK$ 216,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hksyu.edu/bba/msc" }
                ]},
                { name: "辅导及心理学系", majors: [
                    { cn: "心理学硕士", en: "MA in Psychology", deadline: "2025-03-31", fee: "HK$ 144,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hksyu.edu/psych/ma" },
                    { cn: "辅导学硕士", en: "MA in Counselling", deadline: "2025-03-31", fee: "HK$ 144,000", language: "IELTS 6.0", gre: "不要求", url: "https://www.hksyu.edu/psych/mac" }
                ]}
            ]},
            "香港恒生大学": { en: "The Hang Seng University of Hong Kong", location: "中国｜香港｜新界", qs: "暂无", desc: "香港恒生大学成立于2010年，是一所注重商业教育的私立大学。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "市场学硕士", en: "MSc in Marketing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "供应链管理硕士", en: "MSc in Supply Chain Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "传播学院", majors: [
                    { cn: "传播学硕士", en: "MA in Communication", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "数字媒体硕士", en: "MA in Digital Media", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "新闻学硕士", en: "MA in Journalism", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "决策科学学院", majors: [
                    { cn: "数据科学硕士", en: "MSc in Data Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "商业分析硕士", en: "MSc in Business Analytics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "人工智能硕士", en: "MSc in Artificial Intelligence", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "香港珠海学院": { en: "Hong Kong Chu Hai College", location: "中国｜香港｜新界", qs: "暂无", desc: "香港珠海学院成立于1947年，是一所历史悠久的私立学院。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "会计学硕士", en: "MSc in Accounting", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "理工学院", majors: [
                    { cn: "土木工程硕士", en: "MSc in Civil Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "建筑学硕士", en: "MSc in Architecture", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "人文及社会科学学院", majors: [
                    { cn: "中国文学硕士", en: "MA in Chinese Literature", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "新闻传播硕士", en: "MA in Journalism and Communication", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "社会科学硕士", en: "MA in Social Sciences", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "香港高等教育科技学院": { en: "Technological and Higher Education Institute of Hong Kong", location: "中国｜香港｜香港岛", qs: "暂无", desc: "香港高等教育科技学院成立于2012年，是一所应用型高等教育机构。", faculties: [
                { name: "工商及酒店旅游管理学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "酒店管理硕士", en: "MSc in Hospitality Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "旅游管理硕士", en: "MSc in Tourism Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "设计及建筑环境学院", majors: [
                    { cn: "设计学硕士", en: "MSc in Design", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "建筑学硕士", en: "MSc in Architecture", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "室内设计硕士", en: "MSc in Interior Design", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "工程及科学学院", majors: [
                    { cn: "工程学硕士", en: "MSc in Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "应用科学硕士", en: "MSc in Applied Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "信息技术硕士", en: "MSc in Information Technology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "新加坡国立大学": { en: "National University of Singapore", location: "新加坡", qs: "8", desc: "新加坡国立大学成立于1905年，是新加坡最古老、最顶尖的综合性大学。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "商业分析硕士", en: "MSc in Business Analytics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "市场营销硕士", en: "MSc in Marketing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "工程学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "机械工程硕士", en: "MSc in Mechanical Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "土木工程硕士", en: "MSc in Civil Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "化学工程硕士", en: "MSc in Chemical Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "医学院", majors: [
                    { cn: "公共卫生硕士", en: "Master of Public Health", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "护理学硕士", en: "Master of Nursing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "医学硕士", en: "Master of Medicine", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "药学硕士", en: "Master of Pharmacy", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "理学院", majors: [
                    { cn: "数学硕士", en: "MSc in Mathematics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "物理学硕士", en: "MSc in Physics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "化学硕士", en: "MSc in Chemistry", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "生物学硕士", en: "MSc in Biology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "人文与社会科学学院", majors: [
                    { cn: "经济学硕士", en: "MA in Economics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "心理学硕士", en: "MA in Psychology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "社会学硕士", en: "MA in Sociology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "传播学硕士", en: "MA in Communication", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "南洋理工大学": { en: "Nanyang Technological University", location: "新加坡", qs: "12", desc: "南洋理工大学成立于1991年，是一所世界知名的研究型大学，在工程和科技领域领先。", faculties: [
                { name: "南洋商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "商业分析硕士", en: "MSc in Business Analytics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "会计学硕士", en: "MSc in Accountancy", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "工程学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "机械工程硕士", en: "MSc in Mechanical Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "土木工程硕士", en: "MSc in Civil Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "理学院", majors: [
                    { cn: "数学硕士", en: "MSc in Mathematics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "物理学硕士", en: "MSc in Physics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "化学硕士", en: "MSc in Chemistry", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "生物科学硕士", en: "MSc in Biological Sciences", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "人文、艺术与社会科学学院", majors: [
                    { cn: "经济学硕士", en: "MA in Economics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "心理学硕士", en: "MA in Psychology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "传播学硕士", en: "MA in Communication Studies", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "公共政策硕士", en: "MA in Public Policy", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "新加坡管理大学": { en: "Singapore Management University", location: "新加坡", qs: "511", desc: "新加坡管理大学成立于2000年，是一所专注于商业和管理的大学。", faculties: [
                { name: "李光前商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "商业分析硕士", en: "MSc in Business Analytics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "应用金融硕士", en: "MSc in Applied Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "会计学院", majors: [
                    { cn: "专业会计硕士", en: "MSc in Professional Accounting", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "会计学硕士", en: "MSc in Accountancy", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "税务硕士", en: "MSc in Taxation", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "信息系统学院", majors: [
                    { cn: "信息系统硕士", en: "MSc in Information Systems", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "商业IT硕士", en: "MSc in Business IT", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融科技硕士", en: "MSc in Financial Technology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "经济与社会科学院", majors: [
                    { cn: "经济学硕士", en: "MSc in Economics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融经济学硕士", en: "MSc in Financial Economics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "应用经济学硕士", en: "MSc in Applied Economics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "新加坡科技设计大学": { en: "Singapore University of Technology and Design", location: "新加坡", qs: "519", desc: "新加坡科技设计大学成立于2012年，是一所注重创新和设计的大学。", faculties: [
                { name: "工程系统与设计学院", majors: [
                    { cn: "系统工程硕士", en: "MSc in Systems Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "设计工程硕士", en: "MSc in Design Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "建筑技术硕士", en: "MSc in Architecture Technology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "信息系统技术与设计学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "信息系统硕士", en: "MSc in Information Systems", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "人工智能硕士", en: "MSc in Artificial Intelligence", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "科学技术学院", majors: [
                    { cn: "技术管理硕士", en: "MSc in Technology Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "创新设计硕士", en: "MSc in Innovation Design", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "可持续发展硕士", en: "MSc in Sustainable Development", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "新加坡理工大学": { en: "Singapore Institute of Technology", location: "新加坡", qs: "暂无", desc: "新加坡理工大学成立于2009年，是一所应用型大学，注重实践教育。", faculties: [
                { name: "工程系", majors: [
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "机械工程硕士", en: "MSc in Mechanical Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "土木工程硕士", en: "MSc in Civil Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "化学工程与食品技术系", majors: [
                    { cn: "化学工程硕士", en: "MSc in Chemical Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "食品技术硕士", en: "MSc in Food Technology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "信息通讯技术系", majors: [
                    { cn: "信息技术硕士", en: "MSc in Information Technology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "网络安全硕士", en: "MSc in Cybersecurity", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "软件工程硕士", en: "MSc in Software Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "澳门大学": { en: "University of Macau", location: "中国｜澳门｜凼仔", qs: "285", desc: "澳门大学成立于1981年，是澳门最古老的综合性大学。", faculties: [
                { name: "工商管理学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "会计学硕士", en: "MSc in Accounting", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "市场学硕士", en: "MSc in Marketing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "教育学院", majors: [
                    { cn: "教育学硕士", en: "Master of Education", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "课程与教学硕士", en: "MSc in Curriculum and Instruction", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "教育心理学硕士", en: "MSc in Educational Psychology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "法学院", majors: [
                    { cn: "法学硕士", en: "Master of Laws", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "国际商法硕士", en: "MSc in International Business Law", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "宪法与行政法硕士", en: "MSc in Constitutional and Administrative Law", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "社会科学学院", majors: [
                    { cn: "经济学硕士", en: "MSc in Economics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "心理学硕士", en: "MSc in Psychology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "传播学硕士", en: "MSc in Communication", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "社会学硕士", en: "MSc in Sociology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "澳门科技大学": { en: "Macau University of Science and Technology", location: "中国｜澳门｜凼仔", qs: "440", desc: "澳门科技大学成立于2000年，是一所综合性私立大学。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "会计学硕士", en: "MSc in Accounting", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "供应链管理硕士", en: "MSc in Supply Chain Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "法学院", majors: [
                    { cn: "法学硕士", en: "Master of Laws", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "国际经济法硕士", en: "MSc in International Economic Law", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "刑事司法硕士", en: "MSc in Criminal Justice", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "中医药学院", majors: [
                    { cn: "中医学硕士", en: "Master of Chinese Medicine", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "中药学硕士", en: "MSc in Chinese Materia Medica", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "针灸学硕士", en: "MSc in Acupuncture and Moxibustion", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "酒店与旅游管理学院", majors: [
                    { cn: "酒店管理硕士", en: "MSc in Hotel Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "旅游管理硕士", en: "MSc in Tourism Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "会展管理硕士", en: "MSc in Event Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "澳门理工大学": { en: "Macao Polytechnic University", location: "中国｜澳门｜高美士街", qs: "901-950", desc: "澳门理工大学成立于1991年，是一所注重应用教育的公立大学。", faculties: [
                { name: "管理科学学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "公共行政硕士", en: "MSc in Public Administration", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "电子商务硕士", en: "MSc in Electronic Commerce", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "人文社会科学学院", majors: [
                    { cn: "传播学硕士", en: "MSc in Communication", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "社会工作硕士", en: "MSc in Social Work", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "公共行政硕士", en: "MSc in Public Administration", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "健康科学及体育学院", majors: [
                    { cn: "护理学硕士", en: "MSc in Nursing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "体育学硕士", en: "MSc in Sports Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "公共卫生硕士", en: "MSc in Public Health", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "澳门城市大学": { en: "City University of Macau", location: "中国｜澳门｜凼仔", qs: "暂无", desc: "澳门城市大学成立于1981年，是一所综合性私立大学。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "国际旅游管理硕士", en: "MSc in International Tourism Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "人文社会科学学院", majors: [
                    { cn: "教育学硕士", en: "Master of Education", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "心理学硕士", en: "MSc in Psychology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "传播学硕士", en: "MSc in Communication", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "法学院", majors: [
                    { cn: "法学硕士", en: "Master of Laws", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "国际商法硕士", en: "MSc in International Business Law", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "创新设计学院", majors: [
                    { cn: "设计学硕士", en: "MSc in Design", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "城市规划硕士", en: "MSc in Urban Planning", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "西交利物浦大学": { en: "Xi'an Jiaotong-Liverpool University (XJTLU)", location: "中国｜江苏｜苏州", qs: "暂无", desc: "西交利物浦大学成立于2006年，是西安交通大学与利物浦大学合作创办的中外合办大学。", faculties: [
                { name: "西浦国际商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "管理学硕士", en: "MSc in Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "商业分析硕士", en: "MSc in Business Analytics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "设计学院", majors: [
                    { cn: "建筑设计硕士", en: "MSc in Architectural Design", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "城市规划硕士", en: "MSc in Urban Planning", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "工业设计硕士", en: "MSc in Industrial Design", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "智能工程学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "机械工程硕士", en: "MSc in Mechanical Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "数据科学硕士", en: "MSc in Data Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "宁波诺丁汉大学": { en: "University of Nottingham Ningbo China", location: "中国｜浙江｜宁波", qs: "暂无", desc: "宁波诺丁汉大学成立于2004年，是英国诺丁汉大学在中国设立的第一所中外合办大学。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融与投资硕士", en: "MSc in Finance and Investment", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "市场营销硕士", en: "MSc in Marketing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "国际商务硕士", en: "MSc in International Business", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "人文与社会科学学院", majors: [
                    { cn: "国际关系硕士", en: "MSc in International Relations", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "传播学硕士", en: "MSc in Communication", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "教育学硕士", en: "MSc in Education", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "英语研究硕士", en: "MSc in English Studies", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "理工学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "工程学硕士", en: "MSc in Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "环境科学硕士", en: "MSc in Environmental Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "数学硕士", en: "MSc in Mathematics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "香港中文大学（深圳）": { en: "The Chinese University of Hong Kong (Shenzhen)", location: "中国｜广东｜深圳", qs: "暂无", desc: "香港中文大学（深圳）成立于2014年，是香港中文大学在深圳设立的分校区。", faculties: [
                { name: "经管学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "会计学硕士", en: "MSc in Accounting", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "市场学硕士", en: "MSc in Marketing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "经济学硕士", en: "MSc in Economics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "理工学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "材料科学硕士", en: "MSc in Materials Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "数据科学硕士", en: "MSc in Data Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "人文社科学院", majors: [
                    { cn: "翻译硕士", en: "MA in Translation", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "同声传译硕士", en: "MA in Conference Interpreting", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "应用心理学硕士", en: "MA in Applied Psychology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "全球研究硕士", en: "MA in Global Studies", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "数据科学学院", majors: [
                    { cn: "数据科学硕士", en: "MSc in Data Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "人工智能硕士", en: "MSc in Artificial Intelligence", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "商业分析硕士", en: "MSc in Business Analytics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "香港科技大学（广州）": { en: "The Hong Kong University of Science and Technology (Guangzhou)", location: "中国｜广东｜广州", qs: "暂无", desc: "香港科技大学（广州）成立于2022年，是香港科技大学在广州设立的分校区。", faculties: [
                { name: "信息枢纽", majors: [
                    { cn: "人工智能硕士", en: "MSc in Artificial Intelligence", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "数据科学与分析硕士", en: "MSc in Data Science and Analytics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "物联网硕士", en: "MSc in Internet of Things", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "功能枢纽", majors: [
                    { cn: "材料科学硕士", en: "MSc in Materials Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "可持续能源硕士", en: "MSc in Sustainable Energy", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "生物医药工程硕士", en: "MSc in Biomedical Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "系统枢纽", majors: [
                    { cn: "智能制造硕士", en: "MSc in Intelligent Manufacturing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "智能交通硕士", en: "MSc in Intelligent Transportation", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "城市治理硕士", en: "MSc in Urban Governance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "社会枢纽", majors: [
                    { cn: "创新创业硕士", en: "MSc in Innovation and Entrepreneurship", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融科技硕士", en: "MSc in Financial Technology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "公共政策硕士", en: "MSc in Public Policy", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "香港城市大学（东莞）": { en: "City University of Hong Kong (Dongguan)", location: "中国｜广东｜东莞", qs: "暂无", desc: "香港城市大学（东莞）是香港城市大学在东莞设立的分校区。", faculties: [
                { name: "商学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "金融学硕士", en: "MSc in Finance", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "商业分析硕士", en: "MSc in Business Analytics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "市场营销硕士", en: "MSc in Marketing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "工程学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "电子工程硕士", en: "MSc in Electronic Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "机械工程硕士", en: "MSc in Mechanical Engineering", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "材料科学硕士", en: "MSc in Materials Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "数据科学学院", majors: [
                    { cn: "数据科学硕士", en: "MSc in Data Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "人工智能硕士", en: "MSc in Artificial Intelligence", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "统计学硕士", en: "MSc in Statistics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "创新创业学院", majors: [
                    { cn: "创新创业硕士", en: "MSc in Innovation and Entrepreneurship", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "项目管理硕士", en: "MSc in Project Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]},
            "北师香港浸会大学": { en: "Beijing Normal-Hong Kong Baptist University", location: "中国｜广东｜珠海", qs: "暂无", desc: "北师香港浸会大学成立于2005年，是北京师范大学与香港浸会大学合作创办的中外合办大学。", faculties: [
                { name: "工商管理学院", majors: [
                    { cn: "工商管理硕士", en: "Master of Business Administration (MBA)", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "会计学硕士", en: "MSc in Accounting", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "应用经济学硕士", en: "MSc in Applied Economics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "人力资源管理硕士", en: "MSc in Human Resource Management", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "人文与社会科学学院", majors: [
                    { cn: "传播学硕士", en: "MSc in Communication", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "社会工作硕士", en: "MSc in Social Work", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "教育学硕士", en: "MSc in Education", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "心理学硕士", en: "MSc in Psychology", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "理工科技学院", majors: [
                    { cn: "计算机科学硕士", en: "MSc in Computer Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "应用数学硕士", en: "MSc in Applied Mathematics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "环境科学硕士", en: "MSc in Environmental Science", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "统计学硕士", en: "MSc in Statistics", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]},
                { name: "文化与创意学院", majors: [
                    { cn: "电影电视硕士", en: "MSc in Film and Television", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "创意写作硕士", en: "MSc in Creative Writing", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" },
                    { cn: "音乐硕士", en: "MSc in Music", deadline: "待更新", fee: "待更新", language: "待更新", gre: "待更新", url: "#" }
                ]}
            ]}
        };

        let majorDb = JSON.parse(localStorage.getItem('yaying_majors')) || [];
        let currentActiveList = [];

        window.onload = () => { renderHome(); };

        // --- 视图切换 ---
        function toggleView() {
            const isUser = document.getElementById('view-user').style.display !== 'none';
            document.getElementById('view-user').style.display = isUser ? 'none' : 'block';
            document.getElementById('view-admin').style.display = isUser ? 'block' : 'none';
            document.getElementById('modeSwitch').innerText = isUser ? "切换至用户视图" : "切换至管理后台";
            if(isUser) switchAdminNav('data');
            else renderHome();
        }

        function renderHome() {
            const grid = document.getElementById('uniGrid');
            grid.innerHTML = uniList.map(u => {
                let count = 0;
                if (uniDetails[u.name]) {
                    uniDetails[u.name].faculties.forEach(fac => {
                        count += fac.majors.length;
                    });
                }
                
                return `
                    <div class="uni-card" onclick="openUni('${u.name}')">
                        <span style="position:absolute; top:15px; right:20px; background:var(--qs-gold); font-size:11px; font-weight:bold; padding:3px 12px; border-radius:50px;">${u.qs}</span>
                        <h3 style="font-size:20px;">${u.name}</h3>
                        <p style="color:#999; font-size:14px; margin-top:4px;">${u.en}</p>
                        <div style="margin-top:20px; font-size:12px; color:var(--primary); font-weight:bold; background:#F0FFF4; display:inline-block; padding:4px 12px; border-radius:10px;">
                            <i class="fas fa-check-circle"></i> 已收录 ${count} 个专业
                        </div>
                    </div>
                `;
            }).join('');
        }

        // --- 管理后台功能 ---
        function switchAdminNav(type) {
            document.querySelectorAll('.admin-sidebar li').forEach(li => li.classList.remove('active'));
            document.getElementById('nav-' + type).classList.add('active');
            const body = document.getElementById('adminBody');

            if(type === 'data') {
                body.innerHTML = `
                    <h2>智能数据入库</h2>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:25px; margin-top:20px;">
                        <div class="form-card">
                            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                                <div class="form-group"><label>学校名称</label><select id="f_uni">${Object.keys(uniDetails).map(u=>`<option>${u}</option>`)}</select></div>
                                <div class="form-group"><label>学院名称</label><input id="f_fac" placeholder="如：商学院"></div>
                                <div class="form-group"><label>专业名称（中文）</label><input id="f_cn"></div>
                                <div class="form-group"><label>专业名称（英文）</label><input id="f_en"></div>
                                <div class="form-group"><label>申请截止时间</label><input id="f_deadline" placeholder="如：2025-03-15"></div>
                                <div class="form-group"><label>学费</label><input id="f_fee" placeholder="如：HK$ 580,000"></div>
                                <div class="form-group"><label>学制</label><input id="f_duration" placeholder="如：1年"></div>
                                <div class="form-group"><label>雅思要求</label><input id="f_language" placeholder="如：IELTS 6.5"></div>
                                <div class="form-group"><label>托福要求</label><input id="f_toefl" placeholder="如：TOEFL 80"></div>
                                <div class="form-group"><label>GRE/GMAT</label><input id="f_gre" placeholder="如：建议/不要求"></div>
                                <div class="form-group"><label>官网链接</label><input id="f_url" placeholder="https://..."></div>
                                <div class="form-group"><label>申请要求链接</label><input id="f_req_url" placeholder="https://..."></div>
                            </div>
                            <div class="form-group"><label>专业概况</label><textarea id="f_overview" rows="3" placeholder="专业介绍和培养目标"></textarea></div>
                            <div class="form-group"><label>课程结构</label><textarea id="f_curriculum" rows="3" placeholder="核心课程和选修课程"></textarea></div>
                            <div class="form-group"><label>学术要求</label><textarea id="f_academic" rows="3" placeholder="申请者的学术背景要求"></textarea></div>
                            <button class="mode-btn active" style="width:100%; padding:12px;" onclick="saveNewMajor()">保存到正式数据库</button>
                        </div>
                        <div>
                            <div class="form-card" style="border: 1px dashed var(--primary); background: #F0FFF4;">
                                <h3 style="font-size:15px; margin-bottom:15px;"><i class="fas fa-robot"></i> AI 智能识别助手</h3>
                                
                                <div class="ocr-zone" onclick="document.getElementById('ocrInput').click()">
                                    <i class="fas fa-cloud-upload-alt" style="font-size:24px; color:#A0AEC0;"></i>
                                    <p style="margin-top:10px; font-size:13px; color:#718096;">点击上传文件（图片、Word、Excel）</p>
                                    <input type="file" id="ocrInput" hidden accept="image/*,.doc,.docx,.xls,.xlsx,.pdf" onchange="handleFileUpload(this)">
                                </div>
                                
                                <div style="margin:15px 0; text-align:center; color:#A0AEC0; font-size:12px;">或</div>
                                
                                <div class="ocr-zone" id="pasteZone" style="min-height:100px;">
                                    <i class="fas fa-paste" style="font-size:24px; color:#A0AEC0;"></i>
                                    <p style="margin-top:10px; font-size:13px; color:#718096;">直接粘贴图片（支持多张）</p>
                                    <p style="margin-top:5px; font-size:11px; color:#CBD5E0;">Ctrl+V 粘贴图片</p>
                                </div>
                                
                                <div id="imagePreview" style="display:none; margin-top:15px; gap:10px; flex-wrap:wrap; justify-content:center;"></div>
                                
                                <div id="ocrStatus" style="display:none; font-size:13px; color:var(--primary);"><i class="fas fa-spinner fa-spin"></i> 正在智能解析中...</div>
                                <div id="ocrRes" style="display:none; margin-top:10px; font-size:12px; background:#FFF; padding:10px; border-radius:8px; border:1px solid #EEE; max-height:200px; overflow-y:auto;"></div>
                                
                                <div id="majorPreview" style="display:none;"></div>
                                
                                <div style="display:flex; gap:10px; margin-top:10px;">
                                    <button id="fillBtn" class="mode-btn" style="display:none; flex:1;" onclick="autoFillForm()">提取信息并填表</button>
                                    <button id="translateBtn" class="mode-btn" style="display:none; flex:1;" onclick="translateToChinese()">翻译英文为中文</button>
                                </div>
                            </div>
                            
                            <div class="form-card" style="border: 1px dashed #4299E1; background: #EBF8FF; margin-top:20px;">
                                <h3 style="font-size:15px; margin-bottom:15px;"><i class="fas fa-file-code"></i> JSON 数据导入</h3>
                                
                                <div class="ocr-zone" onclick="document.getElementById('jsonInput').click()">
                                    <i class="fas fa-upload" style="font-size:24px; color:#4299E1;"></i>
                                    <p style="margin-top:10px; font-size:13px; color:#4A5568;">点击上传 JSON 文件</p>
                                    <input type="file" id="jsonInput" hidden accept=".json" onchange="handleJsonUpload(this)">
                                </div>
                                
                                <div id="jsonStatus" style="display:none; font-size:13px; color:#4299E1; margin-top:10px;"><i class="fas fa-spinner fa-spin"></i> 正在解析 JSON 文件...</div>
                                
                                <div id="jsonPreview" style="display:none; margin-top:15px;">
                                    <div style="font-size:13px; font-weight:600; margin-bottom:10px; color:#2D3748;">JSON 数据预览：</div>
                                    <div id="jsonContent" style="max-height:250px; overflow-y:auto; background:#FFF; padding:10px; border-radius:8px; border:1px solid #E2E8F0; font-size:11px; color:#4A5568;"></div>
                                    <div id="jsonStats" style="margin-top:10px; font-size:12px; color:#4A5568;"></div>
                                    <button id="jsonImportBtn" class="mode-btn" style="display:none; width:100%; margin-top:10px; background:#4299E1;" onclick="importJsonData()">确认导入数据</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if(type === 'crawler') {
                body.innerHTML = `
                    <h2>全校联网监测中心</h2>
                    <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:20px; margin-top:20px;">
                        <div class="form-card" style="text-align:center;">
                            <div style="color:#718096;">活跃监测点</div><div style="font-size:28px; font-weight:bold; color:var(--primary);">428</div>
                        </div>
                        <div class="form-card" style="text-align:center;">
                            <div style="color:#718096;">24h 捕获变动</div><div style="font-size:28px; font-weight:bold; color:#E53E3E;">12</div>
                        </div>
                        <div class="form-card" style="text-align:center;">
                            <div style="color:#718096;">汇率换算基准</div><div style="font-size:28px; font-weight:bold;">0.915</div>
                        </div>
                    </div>
                    <div class="form-card" style="margin-top:20px;">
                        <h3>变动日志</h3>
                        <table style="margin-top:15px;">
                            <thead><tr><th>院校</th><th>检测项</th><th>网页新抓取值</th><th>状态</th><th>操作</th></tr></thead>
                            <tbody>
                                <tr><td>香港大学</td><td>金融学-截止日期</td><td style="color:#E53E3E; font-weight:bold;">2025-02-15</td><td>待审</td><td><button class="mode-btn active" style="padding:4px 10px;">同步</button></td></tr>
                            </tbody>
                        </table>
                    </div>
                `;
            } else if(type === 'manage') {
                renderManageData();
            }
        }

        // --- OCR 逻辑 ---
        let ocrText = '';
        let uploadedImages = [];
        let parsedMajors = [];

        async function handleFileUpload(input) {
            if(!input.files[0]) return;
            
            const file = input.files[0];
            const status = document.getElementById('ocrStatus');
            const resDiv = document.getElementById('ocrRes');
            const fillBtn = document.getElementById('fillBtn');
            const translateBtn = document.getElementById('translateBtn');
            
            status.style.display = 'block';
            resDiv.style.display = 'none';
            fillBtn.style.display = 'none';
            translateBtn.style.display = 'none';
            
            const fileType = file.type;
            const fileName = file.name.toLowerCase();
            
            try {
                let text = '';
                
                if (fileType.startsWith('image/')) {
                    text = await processImage(file);
                } else if (fileName.endsWith('.doc') || fileName.endsWith('.docx')) {
                    text = await processWord(file);
                } else if (fileName.endsWith('.xls') || fileName.endsWith('.xlsx')) {
                    text = await processExcel(file);
                } else if (fileName.endsWith('.pdf')) {
                    text = await processPDF(file);
                } else {
                    alert('不支持的文件格式');
                    status.style.display = 'none';
                    return;
                }
                
                ocrText = text;
                status.style.display = 'none';
                resDiv.innerText = text;
                resDiv.style.display = 'block';
                fillBtn.style.display = 'block';
                translateBtn.style.display = 'block';
                
            } catch (error) {
                console.error('处理文件出错:', error);
                alert('文件处理失败，请重试');
                status.style.display = 'none';
            }
        }

        async function processImage(file) {
            const worker = await Tesseract.createWorker({
                logger: m => {
                    if (m.status === 'recognizing text') {
                        const status = document.getElementById('ocrStatus');
                        if (status && status.style) {
                            status.innerHTML = `<i class="fas fa-spinner fa-spin"></i> 正在识别中... ${Math.round(m.progress * 100)}%`;
                        }
                    }
                }
            });
            
            await worker.loadLanguage('chi_sim+eng');
            await worker.initialize('chi_sim+eng');
            
            const { data: { text } } = await worker.recognize(file, {
                tessedit_char_whitelist: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz.,:;-/\\|()[]{}\'"?!@#$%^&*+=_~` \n\t\r\u4e00-\u9fa5\u3000-\u303f\uff00-\uffef',
                preserve_interword_spaces: '1',
            });
            
            await worker.terminate();
            
            const cleanedText = postProcessText(text);
            return cleanedText;
        }

        function postProcessText(text) {
            let cleaned = text;
            
            cleaned = cleaned.replace(/\s+/g, ' ');
            cleaned = cleaned.replace(/([a-z])([A-Z])/g, '$1 $2');
            cleaned = cleaned.replace(/(\d)([A-Za-z])/g, '$1 $2');
            cleaned = cleaned.replace(/([A-Za-z])(\d)/g, '$1 $2');
            cleaned = cleaned.replace(/([,.:;])([^\s])/g, '$1 $2');
            cleaned = cleaned.replace(/([^\s])([,.:;])/g, '$1 $2');
            cleaned = cleaned.replace(/\s*([,.:;])\s*/g, '$1 ');
            cleaned = cleaned.replace(/HK\s*\$\s*/gi, 'HK$ ');
            cleaned = cleaned.replace(/\$\s*/g, '$ ');
            cleaned = cleaned.replace(/(\d{4})[-.\/](\d{2})[-.\/](\d{2})/g, '$1-$2-$3');
            cleaned = cleaned.replace(/IELTS\s*([\d.]+)/gi, 'IELTS $1');
            cleaned = cleaned.replace(/TOEFL\s*(\d+)/gi, 'TOEFL $1');
            cleaned = cleaned.replace(/GRE\s*([A-Za-z]+)/gi, 'GRE $1');
            cleaned = cleaned.replace(/GMAT\s*([A-Za-z]+)/gi, 'GMAT $1');
            cleaned = cleaned.replace(/Duration\s*[:：]\s*/gi, 'Duration: ');
            cleaned = cleaned.replace(/Deadline\s*[:：]\s*/gi, 'Deadline: ');
            cleaned = cleaned.replace(/Fee\s*[:：]\s*/gi, 'Fee: ');
            cleaned = cleaned.replace(/Tuition\s*[:：]\s*/gi, 'Tuition: ');
            cleaned = cleaned.replace(/Overview\s*[:：]\s*/gi, 'Overview: ');
            cleaned = cleaned.replace(/Curriculum\s*[:：]\s*/gi, 'Curriculum: ');
            cleaned = cleaned.replace(/Academic\s*[:：]\s*/gi, 'Academic: ');
            cleaned = cleaned.replace(/Requirement\s*[:：]\s*/gi, 'Requirement: ');
            cleaned = cleaned.replace(/Required\s*[:：]\s*/gi, 'Required: ');
            cleaned = cleaned.replace(/Recommended\s*[:：]\s*/gi, 'Recommended: ');
            cleaned = cleaned.replace(/Not\s+Required\s*[:：]\s*/gi, 'Not Required: ');
            cleaned = cleaned.replace(/Full[-\s]*time/gi, 'Full-time');
            cleaned = cleaned.replace(/Part[-\s]*time/gi, 'Part-time');
            cleaned = cleaned.replace(/Bachelor/gi, 'Bachelor');
            cleaned = cleaned.replace(/Master/gi, 'Master');
            cleaned = cleaned.replace(/Ph\.?D/gi, 'PhD');
            cleaned = cleaned.replace(/M\.?Sc/gi, 'MSc');
            cleaned = cleaned.replace(/M\.?A/gi, 'MA');
            cleaned = cleaned.replace(/M\.?B\.?A/gi, 'MBA');
            cleaned = cleaned.replace(/M\.?Phil/gi, 'MPhil');
            cleaned = cleaned.replace(/L\.?L\.?M/gi, 'LLM');
            cleaned = cleaned.replace(/D\.?B\.?A/gi, 'DBA');
            cleaned = cleaned.replace(/E\.?d\.?D/gi, 'EdD');
            cleaned = cleaned.replace(/Eng\.?D/gi, 'EngD');
            
            cleaned = cleaned.trim();
            
            return cleaned;
        }

        async function processWord(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = async (e) => {
                    try {
                        const arrayBuffer = e.target.result;
                        const result = await mammoth.extractRawText({ arrayBuffer: arrayBuffer });
                        const cleanedText = postProcessText(result.value);
                        resolve(cleanedText);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        async function processExcel(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        let text = '';
                        
                        workbook.SheetNames.forEach(sheetName => {
                            const worksheet = workbook.Sheets[sheetName];
                            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                            jsonData.forEach(row => {
                                text += row.join(' | ') + '\n';
                            });
                        });
                        
                        const cleanedText = postProcessText(text);
                        resolve(cleanedText);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        async function processPDF(file) {
            const worker = await Tesseract.createWorker({
                logger: m => {
                    if (m.status === 'recognizing text') {
                        const status = document.getElementById('ocrStatus');
                        if (status && status.style) {
                            status.innerHTML = `<i class="fas fa-spinner fa-spin"></i> 正在识别中... ${Math.round(m.progress * 100)}%`;
                        }
                    }
                }
            });
            
            await worker.loadLanguage('chi_sim+eng');
            await worker.initialize('chi_sim+eng');
            
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
            
            let text = '';
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const viewport = page.getViewport({ scale: 1.5 });
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = viewport.width;
                canvas.height = viewport.height;
                
                await page.render({ canvasContext: ctx, viewport: viewport }).promise;
                
                const { data: { text: pageText } } = await worker.recognize(canvas, {
                    tessedit_char_whitelist: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz.,:;-/\\|()[]{}\'"?!@#$%^&*+=_~` \n\t\r\u4e00-\u9fa5\u3000-\u303f\uff00-\uffef',
                    preserve_interword_spaces: '1',
                });
                
                text += pageText + '\n';
            }
            
            await worker.terminate();
            
            const cleanedText = postProcessText(text);
            return cleanedText;
        }

        document.addEventListener('paste', async (e) => {
            const preview = document.getElementById('imagePreview');
            const status = document.getElementById('ocrStatus');
            const resDiv = document.getElementById('ocrRes');
            const fillBtn = document.getElementById('fillBtn');
            const translateBtn = document.getElementById('translateBtn');
            
            if (!preview || !status || !resDiv || !fillBtn || !translateBtn) {
                return;
            }
            
            const items = e.clipboardData.items;
            let hasImage = false;
            uploadedImages = [];
            
            for (let i = 0; i < items.length; i++) {
                if (items[i].type.indexOf('image') !== -1) {
                    hasImage = true;
                    const blob = items[i].getAsFile();
                    uploadedImages.push(blob);
                    
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.style.cssText = 'max-width:150px; max-height:150px; border-radius:8px; border:1px solid #DDD;';
                        preview.appendChild(img);
                    };
                    reader.readAsDataURL(blob);
                }
            }
            
            if (hasImage) {
                e.preventDefault();
                preview.style.display = 'flex';
                status.style.display = 'block';
                resDiv.style.display = 'none';
                fillBtn.style.display = 'none';
                translateBtn.style.display = 'none';
                
                let allText = '';
                for (const image of uploadedImages) {
                    const text = await processImage(image);
                    allText += text + '\n\n';
                }
                
                ocrText = allText;
                status.style.display = 'none';
                resDiv.innerText = allText;
                resDiv.style.display = 'block';
                fillBtn.style.display = 'block';
                translateBtn.style.display = 'block';
            }
        });

        async function runOCR(input) {
            await handleFileUpload(input);
        }

        function autoFillForm() {
            const text = ocrText;
            parsedMajors = [];
            
            const majorSections = text.split(/专业名称|Programme Name|Program Name/i);
            
            for (let i = 0; i < majorSections.length; i++) {
                const section = majorSections[i];
                const major = {
                    cn: '',
                    en: '',
                    deadline: '待更新',
                    fee: '待更新',
                    duration: '待更新',
                    language: '待更新',
                    toefl: '',
                    gre: '待更新',
                    url: '#',
                    req_url: '',
                    overview: '',
                    curriculum: '',
                    academic: ''
                };
                
                const feeMatch = section.match(/HK\$\s*([\d,]+)/i) || section.match(/学费[\s:：]*[\$]?([\d,]+)/i);
                if(feeMatch) major.fee = "HK$ " + feeMatch[1].replace(/,/g, '');
                
                const durationMatch = section.match(/学制[\s:：]*(\d+)\s*年/i) || section.match(/Duration[\s:：]*(\d+)\s*year/i) || section.match(/(\d+)\s*年/i);
                if(durationMatch) major.duration = durationMatch[1] + "年";
                
                const deadlineMatch = section.match(/截止时间[\s:：]*(\d{4}-\d{2}-\d{2})/i) || section.match(/Deadline[\s:：]*(\d{4}-\d{2}-\d{2})/i) || section.match(/Application[\s:：]*(\d{4}-\d{2}-\d{2})/i);
                if(deadlineMatch) major.deadline = deadlineMatch[1];
                
                const ieltsMatch = section.match(/IELTS[\s:：]*([\d\.]+)/i) || section.match(/雅思[\s:：]*([\d\.]+)/i);
                if(ieltsMatch) major.language = "IELTS " + ieltsMatch[1];
                
                const toeflMatch = section.match(/TOEFL[\s:：]*(\d+)/i) || section.match(/托福[\s:：]*(\d+)/i);
                if(toeflMatch) major.toefl = "TOEFL " + toeflMatch[1];
                
                const greMatch = section.match(/GRE[\s:：]*(要求|建议|不要求|Required|Recommended|Not Required)/i) || section.match(/GMAT[\s:：]*(要求|建议|不要求|Required|Recommended|Not Required)/i);
                if(greMatch) {
                    const greText = greMatch[1].toLowerCase();
                    if(greText.includes('要求') || greText.includes('required')) {
                        major.gre = "要求";
                    } else if(greText.includes('建议') || greText.includes('recommended')) {
                        major.gre = "建议";
                    } else if(greText.includes('不要求') || greText.includes('not required')) {
                        major.gre = "不要求";
                    }
                }
                
                const urlMatch = section.match(/https?:\/\/[^\s]+/i);
                if(urlMatch) major.url = urlMatch[0];
                
                const cnNameMatch = section.match(/专业名称[\s:：]*([^\n]+)/i) || section.match(/Programme[\s:：]*([^\n]+)/i);
                if(cnNameMatch) {
                    const name = cnNameMatch[1].trim();
                    if(/^[\u4e00-\u9fa5]+$/.test(name)) {
                        major.cn = name;
                    }
                }
                
                const enNameMatch = section.match(/Programme Name[\s:：]*([^\n]+)/i) || section.match(/Program[\s:：]*([^\n]+)/i);
                if(enNameMatch) {
                    const name = enNameMatch[1].trim();
                    if(/^[a-zA-Z\s]+$/.test(name)) {
                        major.en = name;
                    }
                }
                
                const overviewMatch = section.match(/专业概况[\s:：]*([\s\S]*?)(?=课程结构|$)/i) || section.match(/Overview[\s:：]*([\s\S]*?)(?=Curriculum|$)/i);
                if(overviewMatch) major.overview = overviewMatch[1].trim();
                
                const curriculumMatch = section.match(/课程结构[\s:：]*([\s\S]*?)(?=学术要求|$)/i) || section.match(/Curriculum[\s:：]*([\s\S]*?)(?=Academic|$)/i);
                if(curriculumMatch) major.curriculum = curriculumMatch[1].trim();
                
                const academicMatch = section.match(/学术要求[\s:：]*([\s\S]*?)(?=$)/i) || section.match(/Academic[\s:：]*([\s\S]*?)(?=$)/i);
                if(academicMatch) major.academic = academicMatch[1].trim();
                
                if (major.cn || major.en) {
                    parsedMajors.push(major);
                }
            }
            
            if (parsedMajors.length === 0) {
                const major = {
                    cn: '',
                    en: '',
                    deadline: '待更新',
                    fee: '待更新',
                    duration: '待更新',
                    language: '待更新',
                    toefl: '',
                    gre: '待更新',
                    url: '#',
                    req_url: '',
                    overview: '',
                    curriculum: '',
                    academic: ''
                };
                
                const feeMatch = text.match(/HK\$\s*([\d,]+)/i) || text.match(/学费[\s:：]*[\$]?([\d,]+)/i);
                if(feeMatch) major.fee = "HK$ " + feeMatch[1].replace(/,/g, '');
                
                const durationMatch = text.match(/学制[\s:：]*(\d+)\s*年/i) || text.match(/Duration[\s:：]*(\d+)\s*year/i) || text.match(/(\d+)\s*年/i);
                if(durationMatch) major.duration = durationMatch[1] + "年";
                
                const deadlineMatch = text.match(/截止时间[\s:：]*(\d{4}-\d{2}-\d{2})/i) || text.match(/Deadline[\s:：]*(\d{4}-\d{2}-\d{2})/i) || text.match(/Application[\s:：]*(\d{4}-\d{2}-\d{2})/i);
                if(deadlineMatch) major.deadline = deadlineMatch[1];
                
                const ieltsMatch = text.match(/IELTS[\s:：]*([\d\.]+)/i) || text.match(/雅思[\s:：]*([\d\.]+)/i);
                if(ieltsMatch) major.language = "IELTS " + ieltsMatch[1];
                
                const toeflMatch = text.match(/TOEFL[\s:：]*(\d+)/i) || text.match(/托福[\s:：]*(\d+)/i);
                if(toeflMatch) major.toefl = "TOEFL " + toeflMatch[1];
                
                const greMatch = text.match(/GRE[\s:：]*(要求|建议|不要求|Required|Recommended|Not Required)/i) || text.match(/GMAT[\s:：]*(要求|建议|不要求|Required|Recommended|Not Required)/i);
                if(greMatch) {
                    const greText = greMatch[1].toLowerCase();
                    if(greText.includes('要求') || greText.includes('required')) {
                        major.gre = "要求";
                    } else if(greText.includes('建议') || greText.includes('recommended')) {
                        major.gre = "建议";
                    } else if(greText.includes('不要求') || greText.includes('not required')) {
                        major.gre = "不要求";
                    }
                }
                
                const urlMatch = text.match(/https?:\/\/[^\s]+/i);
                if(urlMatch) major.url = urlMatch[0];
                
                const cnNameMatch = text.match(/专业名称[\s:：]*([^\n]+)/i) || text.match(/Programme[\s:：]*([^\n]+)/i);
                if(cnNameMatch) {
                    const name = cnNameMatch[1].trim();
                    if(/^[\u4e00-\u9fa5]+$/.test(name)) {
                        major.cn = name;
                    }
                }
                
                const enNameMatch = text.match(/Programme Name[\s:：]*([^\n]+)/i) || text.match(/Program[\s:：]*([^\n]+)/i);
                if(enNameMatch) {
                    const name = enNameMatch[1].trim();
                    if(/^[a-zA-Z\s]+$/.test(name)) {
                        major.en = name;
                    }
                }
                
                const overviewMatch = text.match(/专业概况[\s:：]*([\s\S]*?)(?=课程结构|$)/i) || text.match(/Overview[\s:：]*([\s\S]*?)(?=Curriculum|$)/i);
                if(overviewMatch) major.overview = overviewMatch[1].trim();
                
                const curriculumMatch = text.match(/课程结构[\s:：]*([\s\S]*?)(?=学术要求|$)/i) || text.match(/Curriculum[\s:：]*([\s\S]*?)(?=Academic|$)/i);
                if(curriculumMatch) major.curriculum = curriculumMatch[1].trim();
                
                const academicMatch = text.match(/学术要求[\s:：]*([\s\S]*?)(?=$)/i) || text.match(/Academic[\s:：]*([\s\S]*?)(?=$)/i);
                if(academicMatch) major.academic = academicMatch[1].trim();
                
                parsedMajors.push(major);
            }
            
            showMajorPreview();
            alert(`AI 已识别到 ${parsedMajors.length} 个专业，请选择要保存的专业！`);
        }

        function showMajorPreview() {
            const previewDiv = document.getElementById('majorPreview');
            if (!previewDiv) return;
            
            if (parsedMajors.length === 0) {
                previewDiv.style.display = 'none';
                return;
            }
            
            let html = '<div style="margin-top:15px;"><h4 style="font-size:14px; margin-bottom:10px; color:var(--primary);">识别到的专业列表：</h4>';
            html += '<div style="max-height:300px; overflow-y:auto; border:1px solid #E2E8F0; border-radius:8px; padding:10px;">';
            
            parsedMajors.forEach((major, index) => {
                const displayName = major.cn || major.en || `专业 ${index + 1}`;
                html += `<div style="padding:10px; border-bottom:1px solid #E2E8F0; cursor:pointer; transition:background 0.2s;" 
                              onmouseover="this.style.background='#F7FAFC'" 
                              onmouseout="this.style.background='transparent'"
                              onclick="selectMajor(${index})">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <div>
                                    <div style="font-weight:600; font-size:13px; color:#2D3748;">${displayName}</div>
                                    <div style="font-size:11px; color:#718096; margin-top:3px;">
                                        ${major.en ? major.en.substring(0, 50) + (major.en.length > 50 ? '...' : '') : ''}
                                    </div>
                                </div>
                                <button style="padding:4px 8px; font-size:11px; background:var(--primary); color:white; border:none; border-radius:4px; cursor:pointer;" 
                                        onclick="event.stopPropagation(); selectMajor(${index})">选择</button>
                            </div>
                        </div>`;
            });
            
            html += '</div>';
            html += '<div style="margin-top:10px; display:flex; gap:10px;">';
            html += '<button style="flex:1; padding:8px; font-size:12px; background:#48BB78; color:white; border:none; border-radius:6px; cursor:pointer;" onclick="saveAllMajors()">保存全部专业</button>';
            html += '</div></div>';
            
            previewDiv.innerHTML = html;
            previewDiv.style.display = 'block';
        }

        function selectMajor(index) {
            const major = parsedMajors[index];
            if (!major) return;
            
            document.getElementById('f_cn').value = major.cn || '';
            document.getElementById('f_en').value = major.en || '';
            document.getElementById('f_deadline').value = major.deadline || '';
            document.getElementById('f_fee').value = major.fee || '';
            document.getElementById('f_duration').value = major.duration || '';
            document.getElementById('f_language').value = major.language || '';
            document.getElementById('f_toefl').value = major.toefl || '';
            document.getElementById('f_gre').value = major.gre || '';
            document.getElementById('f_url').value = major.url || '';
            document.getElementById('f_req_url').value = major.req_url || '';
            document.getElementById('f_overview').value = major.overview || '';
            document.getElementById('f_curriculum').value = major.curriculum || '';
            document.getElementById('f_academic').value = major.academic || '';
            
            alert(`已选择：${major.cn || major.en}，请检查并补充信息后点击保存！`);
        }

        function saveAllMajors() {
            const uni = document.getElementById('f_uni').value;
            const fac = document.getElementById('f_fac').value;
            
            if (!uni || !fac) {
                alert('请先填写学校名称和学院名称！');
                return;
            }
            
            if (parsedMajors.length === 0) {
                alert('没有可保存的专业！');
                return;
            }
            
            if (!uniDetails[uni]) {
                alert('学校不存在！');
                return;
            }
            
            let faculty = uniDetails[uni].faculties.find(f => f.name === fac);
            if (!faculty) {
                faculty = { name: fac, majors: [] };
                uniDetails[uni].faculties.push(faculty);
            }
            
            let savedCount = 0;
            let skippedCount = 0;
            
            parsedMajors.forEach(major => {
                if (!major.cn && !major.en) {
                    skippedCount++;
                    return;
                }
                
                const existingMajor = faculty.majors.find(m => 
                    (m.cn === major.cn && major.cn) || 
                    (m.en === major.en && major.en)
                );
                
                if (existingMajor) {
                    skippedCount++;
                    return;
                }
                
                faculty.majors.push({
                    cn: major.cn || '',
                    en: major.en || '',
                    deadline: major.deadline || '待更新',
                    fee: major.fee || '待更新',
                    duration: major.duration || '待更新',
                    language: major.language || '待更新',
                    toefl: major.toefl || '',
                    gre: major.gre || '待更新',
                    url: major.url || '#',
                    req_url: major.req_url || '',
                    overview: major.overview || '',
                    curriculum: major.curriculum || '',
                    academic: major.academic || ''
                });
                
                savedCount++;
            });
            
            alert(`批量保存完成！\n成功保存：${savedCount} 个专业\n跳过重复：${skippedCount} 个专业`);
            
            parsedMajors = [];
            document.getElementById('majorPreview').style.display = 'none';
            document.getElementById('ocrRes').style.display = 'none';
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('imagePreview').innerHTML = '';
            document.getElementById('fillBtn').style.display = 'none';
            document.getElementById('translateBtn').style.display = 'none';
            ocrText = '';
        }

        let jsonData = null;

        async function handleJsonUpload(input) {
            if (!input.files[0]) return;
            
            const file = input.files[0];
            const status = document.getElementById('jsonStatus');
            const preview = document.getElementById('jsonPreview');
            const content = document.getElementById('jsonContent');
            const stats = document.getElementById('jsonStats');
            const importBtn = document.getElementById('jsonImportBtn');
            
            status.style.display = 'block';
            preview.style.display = 'none';
            importBtn.style.display = 'none';
            
            try {
                const text = await file.text();
                jsonData = JSON.parse(text);
                
                status.style.display = 'none';
                preview.style.display = 'block';
                
                const uniCount = Object.keys(jsonData).length;
                let facCount = 0;
                let majorCount = 0;
                
                Object.keys(jsonData).forEach(uni => {
                    if (jsonData[uni].faculties) {
                        facCount += jsonData[uni].faculties.length;
                        jsonData[uni].faculties.forEach(fac => {
                            if (fac.majors) {
                                majorCount += fac.majors.length;
                            }
                        });
                    }
                });
                
                content.textContent = JSON.stringify(jsonData, null, 2);
                stats.innerHTML = `<strong>数据统计：</strong><br>学校：${uniCount} 所<br>学院：${facCount} 个<br>专业：${majorCount} 个`;
                importBtn.style.display = 'block';
                
            } catch (error) {
                console.error('JSON 解析失败:', error);
                alert('JSON 文件格式错误，请检查文件内容！');
                status.style.display = 'none';
            }
        }

        function importJsonData() {
            if (!jsonData) {
                alert('没有可导入的数据！');
                return;
            }
            
            let uniAdded = 0;
            let facAdded = 0;
            let majorAdded = 0;
            let majorUpdated = 0;
            
            Object.keys(jsonData).forEach(uniName => {
                const uniData = jsonData[uniName];
                
                if (!uniDetails[uniName]) {
                    uniDetails[uniName] = {
                        en: uniName,
                        location: '待更新',
                        qs: '-',
                        desc: '',
                        faculties: []
                    };
                    uniAdded++;
                }
                
                const faculties = uniData.faculties || uniData;
                
                if (Array.isArray(faculties)) {
                    faculties.forEach(facData => {
                        const facName = facData.name || Object.keys(facData)[0];
                        const majors = facData.majors || facData[facName];
                        
                        let faculty = uniDetails[uniName].faculties.find(f => f.name === facName);
                        
                        if (!faculty) {
                            faculty = { name: facName, majors: [] };
                            uniDetails[uniName].faculties.push(faculty);
                            facAdded++;
                        }
                        
                        if (Array.isArray(majors)) {
                            majors.forEach(majorData => {
                                const existingMajor = faculty.majors.find(m => 
                                    (m.cn === majorData.cn && majorData.cn) || 
                                    (m.en === majorData.en && majorData.en)
                                );
                                
                                if (existingMajor) {
                                    Object.assign(existingMajor, {
                                        cn: majorData.cn || existingMajor.cn,
                                        en: majorData.en || existingMajor.en,
                                        deadline: majorData.deadline || existingMajor.deadline,
                                        fee: majorData.fee || existingMajor.fee,
                                        duration: majorData.duration || existingMajor.duration,
                                        language: majorData.language || existingMajor.language,
                                        toefl: majorData.toefl || existingMajor.toefl,
                                        gre: majorData.gre || existingMajor.gre,
                                        url: majorData.url || existingMajor.url,
                                        req_url: majorData.req_url || existingMajor.req_url,
                                        overview: majorData.overview || existingMajor.overview,
                                        curriculum: majorData.curriculum || existingMajor.curriculum,
                                        academic: majorData.academic || existingMajor.academic
                                    });
                                    majorUpdated++;
                                } else {
                                    faculty.majors.push({
                                        cn: majorData.cn || '',
                                        en: majorData.en || '',
                                        deadline: majorData.deadline || '待更新',
                                        fee: majorData.fee || '待更新',
                                        duration: majorData.duration || '待更新',
                                        language: majorData.language || '待更新',
                                        toefl: majorData.toefl || '',
                                        gre: majorData.gre || '待更新',
                                        url: majorData.url || '#',
                                        req_url: majorData.req_url || '',
                                        overview: majorData.overview || '',
                                        curriculum: majorData.curriculum || '',
                                        academic: majorData.academic || ''
                                    });
                                    majorAdded++;
                                }
                            });
                        }
                    });
                } else if (typeof faculties === 'object') {
                    Object.keys(faculties).forEach(facName => {
                        const majors = faculties[facName];
                        
                        let faculty = uniDetails[uniName].faculties.find(f => f.name === facName);
                        
                        if (!faculty) {
                            faculty = { name: facName, majors: [] };
                            uniDetails[uniName].faculties.push(faculty);
                            facAdded++;
                        }
                        
                        if (Array.isArray(majors)) {
                            majors.forEach(majorData => {
                                const existingMajor = faculty.majors.find(m => 
                                    (m.cn === majorData.cn && majorData.cn) || 
                                    (m.en === majorData.en && majorData.en)
                                );
                                
                                if (existingMajor) {
                                    Object.assign(existingMajor, {
                                        cn: majorData.cn || existingMajor.cn,
                                        en: majorData.en || existingMajor.en,
                                        deadline: majorData.deadline || existingMajor.deadline,
                                        fee: majorData.fee || existingMajor.fee,
                                        duration: majorData.duration || existingMajor.duration,
                                        language: majorData.language || existingMajor.language,
                                        toefl: majorData.toefl || existingMajor.toefl,
                                        gre: majorData.gre || existingMajor.gre,
                                        url: majorData.url || existingMajor.url,
                                        req_url: majorData.req_url || existingMajor.req_url,
                                        overview: majorData.overview || existingMajor.overview,
                                        curriculum: majorData.curriculum || existingMajor.curriculum,
                                        academic: majorData.academic || existingMajor.academic
                                    });
                                    majorUpdated++;
                                } else {
                                    faculty.majors.push({
                                        cn: majorData.cn || '',
                                        en: majorData.en || '',
                                        deadline: majorData.deadline || '待更新',
                                        fee: majorData.fee || '待更新',
                                        duration: majorData.duration || '待更新',
                                        language: majorData.language || '待更新',
                                        toefl: majorData.toefl || '',
                                        gre: majorData.gre || '待更新',
                                        url: majorData.url || '#',
                                        req_url: majorData.req_url || '',
                                        overview: majorData.overview || '',
                                        curriculum: majorData.curriculum || '',
                                        academic: majorData.academic || ''
                                    });
                                    majorAdded++;
                                }
                            });
                        }
                    });
                }
            });
            
            alert(`JSON 数据导入完成！\n\n新增学校：${uniAdded} 所\n新增学院：${facAdded} 个\n新增专业：${majorAdded} 个\n更新专业：${majorUpdated} 个`);
            
            jsonData = null;
            document.getElementById('jsonPreview').style.display = 'none';
            document.getElementById('jsonInput').value = '';
            
            renderHome();
        }

        async function translateToChinese() {
            const text = ocrText;
            const status = document.getElementById('ocrStatus');
            const resDiv = document.getElementById('ocrRes');
            
            status.style.display = 'block';
            status.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 正在翻译中...';
            
            try {
                const translatedText = await translateText(text);
                
                ocrText = translatedText;
                status.style.display = 'none';
                resDiv.innerText = translatedText;
                resDiv.style.display = 'block';
                
                alert('翻译完成！已更新识别结果');
            } catch (error) {
                console.error('翻译失败:', error);
                alert('翻译失败，请重试');
                status.style.display = 'none';
            }
        }

        async function translateText(text) {
            const translations = {
                'Programme': '专业',
                'Program': '专业',
                'Programme Name': '专业名称',
                'Program Name': '专业名称',
                'Duration': '学制',
                'Tuition Fee': '学费',
                'Fee': '学费',
                'Application Deadline': '申请截止时间',
                'Deadline': '截止时间',
                'Language Requirement': '语言要求',
                'IELTS': '雅思',
                'TOEFL': '托福',
                'GRE': 'GRE',
                'GMAT': 'GMAT',
                'Required': '要求',
                'Recommended': '建议',
                'Not Required': '不要求',
                'Overview': '专业概况',
                'Curriculum': '课程结构',
                'Academic Requirements': '学术要求',
                'Admission Requirements': '申请要求',
                'Course Structure': '课程结构',
                'Core Courses': '核心课程',
                'Elective Courses': '选修课程',
                'Prerequisites': '先修课程',
                'Credit': '学分',
                'Semester': '学期',
                'Year': '年',
                'Full-time': '全日制',
                'Part-time': '兼读制',
                'Bachelor': '学士',
                'Master': '硕士',
                'PhD': '博士',
                'Degree': '学位',
                'School': '学院',
                'Faculty': '学院',
                'Department': '系',
                'University': '大学',
                'Campus': '校区',
                'Website': '官网',
                'Official Website': '官方网站',
                'Application': '申请',
                'Apply': '申请',
                'Admission': '录取',
                'Enrollment': '入学',
                'Graduation': '毕业',
                'GPA': '平均绩点',
                'Transcript': '成绩单',
                'Recommendation Letter': '推荐信',
                'Personal Statement': '个人陈述',
                'Resume': '简历',
                'CV': '简历',
                'Portfolio': '作品集',
                'Interview': '面试',
                'English Proficiency': '英语水平',
                'Language Proficiency': '语言水平',
                'Test Score': '考试成绩',
                'Score': '分数',
                'Minimum': '最低',
                'Maximum': '最高',
                'Average': '平均',
                'Required Documents': '所需文件',
                'Documents': '文件',
                'Supporting Documents': '支持文件',
                'Additional Information': '额外信息',
                'Notes': '备注',
                'Contact': '联系方式',
                'Email': '邮箱',
                'Phone': '电话',
                'Address': '地址',
                'Office Hours': '办公时间',
                'Hong Kong': '香港',
                'Singapore': '新加坡',
                'Macau': '澳门',
                'China': '中国',
                'Mainland': '内地',
                'International': '国际',
                'Overseas': '海外',
                'Local': '本地',
                'Non-local': '非本地',
                'Full-time Student': '全日制学生',
                'Part-time Student': '兼读制学生',
                'Credit Hours': '学分时',
                'Credit Units': '学分单位',
                'Coursework': '课程作业',
                'Thesis': '论文',
                'Dissertation': '学位论文',
                'Project': '项目',
                'Internship': '实习',
                'Practicum': '实习',
                'Research': '研究',
                'Study': '学习',
                'Learning': '学习',
                'Teaching': '教学',
                'Assessment': '评估',
                'Examination': '考试',
                'Assignment': '作业',
                'Presentation': '演示',
                'Case Study': '案例研究',
                'Group Work': '小组工作',
                'Individual Work': '个人工作',
                'Laboratory': '实验室',
                'Workshop': '工作坊',
                'Seminar': '研讨会',
                'Lecture': '讲座',
                'Tutorial': '辅导课',
                'Practical': '实践课',
                'Fieldwork': '实地考察',
                'Exchange': '交换',
                'Study Abroad': '海外学习',
                'Summer School': '暑期学校',
                'Winter School': '冬季学校',
                'Scholarship': '奖学金',
                'Financial Aid': '经济资助',
                'Grant': '助学金',
                'Loan': '贷款',
                'Bursary': '助学金',
                'Assistantship': '助教金',
                'Tuition Waiver': '学费减免',
                'Living Expenses': '生活费用',
                'Accommodation': '住宿',
                'Housing': '住房',
                'Dormitory': '宿舍',
                'Campus Life': '校园生活',
                'Student Services': '学生服务',
                'Career Services': '就业服务',
                'Alumni': '校友',
                'Graduate': '毕业生',
                'Undergraduate': '本科生',
                'Postgraduate': '研究生',
                'Research Student': '研究型学生',
                'Taught Student': '授课型学生',
                'MPhil': '哲学硕士',
                'MSc': '理学硕士',
                'MA': '文学硕士',
                'MBA': '工商管理硕士',
                'MPA': '公共管理硕士',
                'LLM': '法学硕士',
                'MEng': '工程硕士',
                'MEd': '教育学硕士',
                'MFA': '艺术硕士',
                'DBA': '工商管理博士',
                'PhD': '哲学博士',
                'EdD': '教育学博士',
                'EngD': '工程博士'
            };
            
            let translatedText = text;
            
            Object.keys(translations).forEach(english => {
                const chinese = translations[english];
                const regex = new RegExp(`\\b${english}\\b`, 'gi');
                translatedText = translatedText.replace(regex, chinese);
            });
            
            return translatedText;
        }

        function saveNewMajor() {
            const uni = document.getElementById('f_uni').value;
            const fac = document.getElementById('f_fac').value;
            const cn = document.getElementById('f_cn').value;
            const en = document.getElementById('f_en').value;
            
            if (!uni || !fac || !cn || !en) {
                alert('请填写学校名称、学院名称和专业名称！');
                return;
            }
            
            const newMajor = {
                cn: cn,
                en: en,
                deadline: document.getElementById('f_deadline').value || '待更新',
                fee: document.getElementById('f_fee').value || '待更新',
                duration: document.getElementById('f_duration').value || '待更新',
                language: document.getElementById('f_language').value || '待更新',
                toefl: document.getElementById('f_toefl').value || '',
                gre: document.getElementById('f_gre').value || '待更新',
                url: document.getElementById('f_url').value || '#',
                req_url: document.getElementById('f_req_url').value || '',
                overview: document.getElementById('f_overview').value || '',
                curriculum: document.getElementById('f_curriculum').value || '',
                academic: document.getElementById('f_academic').value || ''
            };
            
            if (!uniDetails[uni]) {
                alert('学校不存在！');
                return;
            }
            
            const faculty = uniDetails[uni].faculties.find(f => f.name === fac);
            if (faculty) {
                faculty.majors.push(newMajor);
            } else {
                uniDetails[uni].faculties.push({
                    name: fac,
                    majors: [newMajor]
                });
            }
            
            alert("专业已成功保存到" + uni + "的" + fac + "！");
            switchAdminNav('data');
        }

        // --- 核心查询逻辑 (修复点击) ---
        function openUni(u) {
            const uniData = uniDetails[u];
            if (!uniData) return;
            
            currentActiveList = [];
            uniData.faculties.forEach(fac => {
                fac.majors.forEach(major => {
                    currentActiveList.push({
                        uni: u,
                        fac: fac.name,
                        cn: major.cn,
                        en: major.en,
                        dur: major.duration || '待更新',
                        fee: major.fee,
                        deadline: major.deadline,
                        language: major.language,
                        toefl: major.toefl,
                        gre: major.gre,
                        url: major.url,
                        req_url: major.req_url,
                        overview: major.overview,
                        curriculum: major.curriculum,
                        academic: major.academic
                    });
                });
            });
            
            renderList(currentActiveList, u, false);
        }

        function globalSearch() {
            const k = document.getElementById('gInput').value.trim();
            if(!k) return;
            
            currentActiveList = [];
            Object.keys(uniDetails).forEach(uni => {
                const uniData = uniDetails[uni];
                uniData.faculties.forEach(fac => {
                    fac.majors.forEach(major => {
                        if (major.cn.includes(k) || major.en.includes(k) || uni.includes(k)) {
                            currentActiveList.push({
                                uni: uni,
                                fac: fac.name,
                                cn: major.cn,
                                en: major.en,
                                dur: major.duration || '待更新',
                                fee: major.fee,
                                deadline: major.deadline,
                                language: major.language,
                                toefl: major.toefl,
                                gre: major.gre,
                                url: major.url,
                                req_url: major.req_url,
                                overview: major.overview,
                                curriculum: major.curriculum,
                                academic: major.academic
                            });
                        }
                    });
                });
            });
            
            renderList(currentActiveList, `全库搜索: ${k}`, true);
        }

        function renderList(list, title, isSearch) {
            document.getElementById('listOverlay').style.display = 'flex';
            document.getElementById('lTitle').innerText = title;
            const tabRow = document.getElementById('facTabs');
            const facs = [...new Set(list.map(m => isSearch ? `${m.uni} - ${m.fac}` : m.fac))];
            
            tabRow.innerHTML = facs.map((f, i) => `
                <div class="fac-tab ${i===0?'active':''}" onclick="switchFac('${f}', this)">${f}</div>
            `).join('');

            if(facs.length > 0) switchFac(facs[0], null);
        }

        function switchFac(facName, el) {
            if(el) {
                document.querySelectorAll('.fac-tab').forEach(t => t.classList.remove('active'));
                el.classList.add('active');
            }
            const filtered = currentActiveList.filter(m => {
                const key = document.getElementById('lTitle').innerText.includes("搜索") ? `${m.uni} - ${m.fac}` : m.fac;
                return key === facName;
            });

            document.getElementById('lContent').innerHTML = `
                <table>
                    <thead><tr><th width="40%">专业名称</th><th width="15%">学制</th><th width="15%">参考学费</th><th width="15%">操作</th></tr></thead>
                    <tbody>
                        ${filtered.map(m => `
                            <tr>
                                <td><b>${m.cn}</b><br><small style="color:#AAA;">${m.en}</small></td>
                                <td>${m.dur}年</td>
                                <td style="color:var(--primary); font-weight:bold;">HK$ ${m.fee}</td>
                                <td><button class="mode-btn active" style="font-size:11px;" onclick="showDetail('${m.cn}')">深度详情</button></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function showDetail(cn) {
            const m = currentActiveList.find(item => item.cn === cn);
            if (!m) return;
            
            document.getElementById('detailModal').style.display = 'flex';
            document.getElementById('d_tag').innerText = `${m.uni} / ${m.fac}`;
            document.getElementById('d_cn').innerText = m.cn;
            document.getElementById('d_en').innerText = m.en;
            
            let infoHtml = '';
            if (m.deadline) infoHtml += `<span style="background:#F0FFF4; padding:5px 15px; border-radius:50px; font-size:12px; font-weight:bold;">截止时间: ${m.deadline}</span>`;
            if (m.fee) infoHtml += `<span style="background:#F0FFF4; padding:5px 15px; border-radius:50px; font-size:12px; font-weight:bold;">学费: ${m.fee}</span>`;
            if (m.dur) infoHtml += `<span style="background:#F0FFF4; padding:5px 15px; border-radius:50px; font-size:12px; font-weight:bold;">学制: ${m.dur}</span>`;
            if (m.language) infoHtml += `<span style="background:#F0FFF4; padding:5px 15px; border-radius:50px; font-size:12px; font-weight:bold;">雅思: ${m.language}</span>`;
            if (m.toefl) infoHtml += `<span style="background:#F0FFF4; padding:5px 15px; border-radius:50px; font-size:12px; font-weight:bold;">托福: ${m.toefl}</span>`;
            if (m.gre) infoHtml += `<span style="background:#F0FFF4; padding:5px 15px; border-radius:50px; font-size:12px; font-weight:bold;">GRE/GMAT: ${m.gre}</span>`;
            
            document.getElementById('d_info').innerHTML = infoHtml;
            
            let reqText = '';
            if (m.academic) reqText += m.academic + '\n\n';
            if (m.language) reqText += '语言要求：' + m.language + '\n';
            if (m.toefl) reqText += '托福要求：' + m.toefl + '\n';
            if (m.gre) reqText += 'GRE/GMAT：' + m.gre;
            
            document.getElementById('d_req').innerText = reqText || '待更新';
            document.getElementById('d_struct').innerText = m.curriculum || '待更新';
            
            if (m.url) {
                const urlBtn = document.createElement('a');
                urlBtn.href = m.url;
                urlBtn.target = '_blank';
                urlBtn.style.cssText = 'display:inline-block; margin-top:20px; padding:12px 30px; background:var(--m-green-dark); color:white; text-decoration:none; border-radius:25px; font-weight:bold;';
                urlBtn.innerHTML = '<i class="fas fa-external-link-alt"></i> 访问官网';
                
                const existingBtn = document.querySelector('#detailModal a');
                if (existingBtn) existingBtn.remove();
                
                document.getElementById('d_struct').parentNode.appendChild(urlBtn);
            }
        }

        function closeOverlay() { document.getElementById('listOverlay').style.display = 'none'; }
        function closeDetail() { document.getElementById('detailModal').style.display = 'none'; }

        function showUniDetail(name) {
            const uni = uniDetails[name];
            if (!uni) return;
            
            document.getElementById('uniDetailOverlay').style.display = 'flex';
            document.getElementById('ud_cn').innerText = name;
            document.getElementById('ud_en').innerText = uni.en;
            document.getElementById('ud_info').innerHTML = `
                <span style="background:#F0FFF4; padding:5px 15px; border-radius:50px; font-size:12px; font-weight:bold;">地点: ${uni.location}</span>
                <span style="background:#F0FFF4; padding:5px 15px; border-radius:50px; font-size:12px; font-weight:bold;">QS排名: ${uni.qs}</span>
            `;
            document.getElementById('ud_desc').innerText = uni.desc;
            
            const tabsHtml = uni.faculties.map((fac, index) => `
                <div class="faculty-tab ${index === 0 ? 'active' : ''}" onclick="switchFaculty('${name}', ${index}, this)">
                    <i class="fas fa-university"></i> ${fac.name}
                </div>
            `).join('');
            
            document.getElementById('ud_faculties').innerHTML = `
                <div class="faculty-tabs">${tabsHtml}</div>
                <div id="ud_majors" class="majors-list"></div>
            `;
            
            switchFaculty(name, 0, null);
        }

        function closeUniDetail() { document.getElementById('uniDetailOverlay').style.display = 'none'; }

        function switchFaculty(name, index, el) {
            if (el) {
                document.querySelectorAll('#ud_faculties .faculty-tab').forEach(tab => tab.classList.remove('active'));
                el.classList.add('active');
            }
            
            const uni = uniDetails[name];
            const fac = uni.faculties[index];
            
            const majorsHtml = `
                <table class="majors-table">
                    <thead>
                        <tr>
                            <th width="30%">专业名称</th>
                            <th width="18%">申请截止时间</th>
                            <th width="18%">学费</th>
                            <th width="17%">语言要求</th>
                            <th width="17%">GRE/GMAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${fac.majors.map(m => `
                            <tr onclick="showMajorDetail('${m.cn}', '${m.en}', '${m.deadline}', '${m.fee}', '${m.language}', '${m.gre}', '${m.url}', '${name}', '${fac.name}')" style="cursor:pointer;">
                                <td>
                                    <div style="font-weight:bold; color:#2D3436; font-size:14px;">${m.cn}</div>
                                    <div style="color:#A0AEC0; font-size:12px; margin-top:2px;">${m.en}</div>
                                </td>
                                <td style="font-size:13px; color:#4A5568;">${m.deadline}</td>
                                <td style="font-size:13px; color:var(--m-green-dark); font-weight:bold;">${m.fee}</td>
                                <td style="font-size:13px; color:#4A5568;">${m.language}</td>
                                <td style="font-size:13px; color:#4A5568;">${m.gre}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            document.getElementById('ud_majors').innerHTML = majorsHtml;
        }

        function showMajorDetail(cn, en, deadline, fee, language, gre, url, school, faculty) {
            const uniData = uniDetails[school];
            let major = null;
            
            if (uniData) {
                const facultyData = uniData.faculties.find(f => f.name === faculty);
                if (facultyData) {
                    major = facultyData.majors.find(m => m.cn === cn);
                }
            }
            
            document.getElementById('majorDetailOverlay').style.display = 'flex';
            document.getElementById('md_cn').innerText = cn;
            document.getElementById('md_en').innerText = en;
            document.getElementById('md_school').innerText = school || '待更新';
            document.getElementById('md_faculty').innerText = faculty || '待更新';
            document.getElementById('md_deadline').innerText = deadline || '待更新';
            document.getElementById('md_fee_amount').innerText = fee || '待更新';
            document.getElementById('md_duration').innerText = major?.duration || '待更新';
            document.getElementById('md_ielts').innerText = language || '待更新';
            document.getElementById('md_toefl').innerText = major?.toefl || '待更新';
            document.getElementById('md_gre').innerText = gre || '待更新';
            document.getElementById('md_url').href = url || '#';
            document.getElementById('md_req_url').href = major?.req_url || url || '#';
            document.getElementById('md_overview').innerText = major?.overview || '本专业旨在培养具备专业知识和实践能力的优秀人才，课程设置紧密结合行业需求，为学生提供全面的理论基础和实践技能训练。毕业生可在相关领域从事专业工作或继续深造。';
            document.getElementById('md_curriculum').innerText = major?.curriculum || '核心课程包括：专业基础课程、高级专题课程、实践项目、毕业论文等。课程设置注重理论与实践相结合，培养学生解决实际问题的能力。';
            document.getElementById('md_academic').innerText = major?.academic || '申请者需具备相关专业的本科学位，GPA不低于3.0/4.0或同等水平。部分专业可能要求相关工作经验或提交作品集。';
        }

        function closeMajorDetail() { document.getElementById('majorDetailOverlay').style.display = 'none'; }
        function closeUniDetail() { document.getElementById('uniDetailOverlay').style.display = 'none'; }

        function renderManageData() {
            const body = document.getElementById('adminBody');
            const unis = Object.keys(uniDetails);
            
            body.innerHTML = `
                <h2>数据管理</h2>
                <div style="margin-top:20px;">
                    <div style="display:flex; gap:15px; margin-bottom:20px; flex-wrap:wrap;">
                        <select id="manageUniSelect" onchange="filterManageData()" style="padding:10px 20px; border:1px solid #E2E8F0; border-radius:8px; font-size:14px;">
                            <option value="">选择大学</option>
                            ${unis.map(u => `<option value="${u}">${u}</option>`).join('')}
                        </select>
                        <input type="text" id="manageSearch" placeholder="搜索专业..." oninput="filterManageData()" style="padding:10px 20px; border:1px solid #E2E8F0; border-radius:8px; font-size:14px; flex:1;">
                    </div>
                    <div id="manageDataList" style="max-height:600px; overflow-y:auto;"></div>
                </div>
            `;
            
            filterManageData();
        }

        function filterManageData() {
            const uni = document.getElementById('manageUniSelect').value;
            const search = document.getElementById('manageSearch').value.toLowerCase();
            const container = document.getElementById('manageDataList');
            
            let html = '';
            
            if (uni) {
                const uniData = uniDetails[uni];
                uniData.faculties.forEach(fac => {
                    fac.majors.forEach(major => {
                        if (!search || major.cn.toLowerCase().includes(search) || major.en.toLowerCase().includes(search)) {
                            html += `
                                <div class="manage-item" style="background:white; padding:15px 20px; border-radius:10px; border:1px solid #E2E8F0; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;">
                                    <div style="flex:1;">
                                        <div style="font-weight:bold; font-size:15px; color:#2D3436;">${major.cn}</div>
                                        <div style="font-size:13px; color:#A0AEC0;">${major.en}</div>
                                        <div style="font-size:12px; color:#718096; margin-top:5px;">${fac.name}</div>
                                    </div>
                                    <div style="display:flex; gap:10px;">
                                        <button onclick="editMajor('${uni}', '${fac.name}', '${major.cn}')" style="padding:8px 16px; background:var(--m-green-dark); color:white; border:none; border-radius:20px; cursor:pointer; font-size:13px;">编辑</button>
                                        <button onclick="deleteMajor('${uni}', '${fac.name}', '${major.cn}')" style="padding:8px 16px; background:#E53E3E; color:white; border:none; border-radius:20px; cursor:pointer; font-size:13px;">删除</button>
                                    </div>
                                </div>
                            `;
                        }
                    });
                });
            } else {
                html = '<div style="text-align:center; padding:40px; color:#718096;">请选择大学查看专业数据</div>';
            }
            
            container.innerHTML = html;
        }

        function editMajor(uni, fac, majorName) {
            const uniData = uniDetails[uni];
            const faculty = uniData.faculties.find(f => f.name === fac);
            const major = faculty.majors.find(m => m.cn === majorName);
            
            if (!major) return;
            
            const editHtml = `
                <div style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:4000; display:flex; justify-content:center; align-items:center;">
                    <div style="background:white; width:90%; max-width:800px; max-height:90vh; border-radius:20px; padding:30px; overflow-y:auto;">
                        <h3 style="margin-bottom:20px; color:var(--m-green-dark);">编辑专业信息</h3>
                        
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:15px;">
                            <div class="form-group"><label>专业名称（中文）</label><input id="edit_cn" value="${major.cn}"></div>
                            <div class="form-group"><label>专业名称（英文）</label><input id="edit_en" value="${major.en}"></div>
                            <div class="form-group"><label>申请截止时间</label><input id="edit_deadline" value="${major.deadline}"></div>
                            <div class="form-group"><label>学费</label><input id="edit_fee" value="${major.fee}"></div>
                            <div class="form-group"><label>学制</label><input id="edit_duration" value="${major.duration || ''}"></div>
                            <div class="form-group"><label>雅思要求</label><input id="edit_language" value="${major.language}"></div>
                            <div class="form-group"><label>托福要求</label><input id="edit_toefl" value="${major.toefl || ''}"></div>
                            <div class="form-group"><label>GRE/GMAT</label><input id="edit_gre" value="${major.gre}"></div>
                            <div class="form-group"><label>官网链接</label><input id="edit_url" value="${major.url}"></div>
                            <div class="form-group"><label>申请要求链接</label><input id="edit_req_url" value="${major.req_url || ''}"></div>
                        </div>
                        
                        <div class="form-group" style="margin-bottom:15px;">
                            <label>专业概况</label>
                            <textarea id="edit_overview" rows="4" style="width:100%; padding:12px; border:1px solid #E2E8F0; border-radius:10px; font-size:14px;">${major.overview || ''}</textarea>
                        </div>
                        
                        <div class="form-group" style="margin-bottom:15px;">
                            <label>课程结构</label>
                            <textarea id="edit_curriculum" rows="4" style="width:100%; padding:12px; border:1px solid #E2E8F0; border-radius:10px; font-size:14px;">${major.curriculum || ''}</textarea>
                        </div>
                        
                        <div class="form-group" style="margin-bottom:20px;">
                            <label>学术要求</label>
                            <textarea id="edit_academic" rows="4" style="width:100%; padding:12px; border:1px solid #E2E8F0; border-radius:10px; font-size:14px;">${major.academic || ''}</textarea>
                        </div>
                        
                        <div style="display:flex; gap:15px; justify-content:flex-end;">
                            <button onclick="closeEditModal()" style="padding:10px 25px; background:#F1F3F5; color:#4A5568; border:none; border-radius:20px; cursor:pointer; font-size:14px;">取消</button>
                            <button onclick="saveEdit('${uni}', '${fac}', '${majorName}')" style="padding:10px 25px; background:var(--m-green-dark); color:white; border:none; border-radius:20px; cursor:pointer; font-size:14px;">保存</button>
                        </div>
                    </div>
                </div>
            `;
            
            const modal = document.createElement('div');
            modal.id = 'editModal';
            modal.innerHTML = editHtml;
            document.body.appendChild(modal);
        }

        function closeEditModal() {
            const modal = document.getElementById('editModal');
            if (modal) modal.remove();
        }

        function saveEdit(uni, fac, oldMajorName) {
            const uniData = uniDetails[uni];
            const faculty = uniData.faculties.find(f => f.name === fac);
            const majorIndex = faculty.majors.findIndex(m => m.cn === oldMajorName);
            
            if (majorIndex === -1) return;
            
            faculty.majors[majorIndex] = {
                cn: document.getElementById('edit_cn').value,
                en: document.getElementById('edit_en').value,
                deadline: document.getElementById('edit_deadline').value,
                fee: document.getElementById('edit_fee').value,
                duration: document.getElementById('edit_duration').value,
                language: document.getElementById('edit_language').value,
                toefl: document.getElementById('edit_toefl').value,
                gre: document.getElementById('edit_gre').value,
                url: document.getElementById('edit_url').value,
                req_url: document.getElementById('edit_req_url').value,
                overview: document.getElementById('edit_overview').value,
                curriculum: document.getElementById('edit_curriculum').value,
                academic: document.getElementById('edit_academic').value
            };
            
            closeEditModal();
            alert('专业信息已更新！');
            filterManageData();
        }

        function deleteMajor(uni, fac, majorName) {
            if (!confirm(`确定要删除"${majorName}"这个专业吗？`)) return;
            
            const uniData = uniDetails[uni];
            const faculty = uniData.faculties.find(f => f.name === fac);
            const majorIndex = faculty.majors.findIndex(m => m.cn === majorName);
            
            if (majorIndex === -1) return;
            
            faculty.majors.splice(majorIndex, 1);
            alert('专业已删除！');
            filterManageData();
        }
    </script>
</body>
</html>