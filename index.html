<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°ä¸œæ–¹æŸ¥æ ¡ç³»ç»Ÿ - äºšæ´²ç•™å­¦ä¸“ä¸šæŸ¥è¯¢</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {},
            },
            corePlugins: {
                preflight: true,
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        .search-box {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .search-box:focus-within {
            border-color: #ff6b35;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }
        .region-tag {
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        .region-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .region-tag.active {
            background: #ff6b35 !important;
            color: white !important;
            border-color: #ff6b35;
        }
        .result-item {
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }
        .result-item:hover {
            background: #fff8f5;
            border-left-color: #ff6b35;
        }
        .checkbox-custom {
            width: 20px;
            height: 20px;
            border: 2px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .checkbox-custom.checked {
            background: #ff6b35;
            border-color: #ff6b35;
        }
        .checkbox-custom.checked::after {
            content: "âœ“";
            color: white;
            font-size: 14px;
            font-weight: bold;
        }
        .school-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .school-item:hover {
            background-color: #f9fafb;
        }
        .major-tag {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        .major-tag:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            background: white;
            overflow-y: auto;
        }
        .detail-modal.active {
            display: block;
        }
        .school-detail-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }
        .school-detail-overlay.active {
            display: block;
        }
        .school-detail-header {
            background: white;
            color: #1f2937;
            padding: 20px;
            position: relative;
            display: flex;
            align-items: center;
            gap: 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        .school-detail-header h2 {
            margin: 0;
            font-size: 1.8rem;
            flex: 1;
        }
        .school-detail-header p {
            margin: 5px 0 0 0;
            opacity: 0.8;
            font-size: 0.9rem;
        }
        .school-detail-content {
            padding: 20px;
            max-width: 1400px;
            margin: auto;
        }
        .school-info-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .school-info-table th, .school-info-table td {
            padding: 12px;
            border: 1px solid #e9ecef;
            text-align: left;
            vertical-align: top;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        .school-info-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            white-space: nowrap;
        }
        .school-info-table td {
            font-size: 14px;
            line-height: 1.5;
            max-width: 0;
        }
        .school-intro {
            line-height: 1.8;
            text-align: justify;
            margin-bottom: 20px;
        }
        .close-school-detail {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            z-index: 10;
        }
        .close-school-detail:hover {
            background: rgba(255,255,255,0.5);
            transform: scale(1.1);
        }
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .detail-modal.active {
            display: flex;
        }
        .detail-content {
            background: white;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            border-radius: 12px;
            overflow: hidden;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .image-detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2000;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
        }
        .image-detail-modal.active {
            display: flex;
        }
        .image-detail-content {
            background: white;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .program-detail-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1001;
            justify-content: center;
            align-items: center;
        }
        .program-detail-overlay.active {
            display: flex;
        }
        .program-detail-modal {
            background: white;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            border-radius: 12px;
            overflow: hidden;
            display: none;
            flex-direction: column;
            animation: slideIn 0.3s ease;
        }
        .program-detail-modal.active {
            display: flex;
        }
        .program-detail-content {
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }
        .program-detail-header {
            background: linear-gradient(135deg, #ff6b35, #dc2626);
            padding: 24px 30px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        .program-detail-header h2 {
            margin: 0;
            font-size: 24px;
            font-weight: bold;
        }
        .program-detail-close {
            background: rgba(255,255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 32px;
            line-height: 1;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .program-detail-close:hover {
            background: rgba(255,255,255,255,0.4);
        }
        .program-detail-body {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
        }
        .program-section {
            margin-bottom: 30px;
        }
        .program-section:last-child {
            margin-bottom: 0;
        }
        .program-section-title {
            font-size: 18px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e5e7eb;
        }
        .program-chinese-name {
            font-size: 20px;
            font-weight: bold;
            color: #1f2937;
            margin: 0 0 8px 0;
        }
        .program-english-name {
            font-size: 16px;
            color: #6b7280;
            font-style: italic;
            margin: 0 0 16px 0;
        }
        .program-website-link {
            display: inline-flex;
            align-items: center;
            padding: 12px 24px;
            background: #ff6b35;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .program-website-link:hover {
            background: #e55a2e;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255,107,53,0.2);
        }
        .program-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        .program-info-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .program-info-label {
            font-size: 13px;
            color: #6b7280;
            font-weight: 500;
        }
        .program-info-value {
            font-size: 15px;
            color: #1f2937;
            font-weight: 600;
        }
        .program-tuition {
            color: #ff6b35;
        }
        .program-curriculum {
            background: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            color: #4b5563;
            font-size: 14px;
            line-height: 1.8;
        }
        .program-detail-footer {
            padding: 20px 30px;
            border-top: 1px solid #f3f4f6;
            background: #f9fafb;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            flex-shrink: 0;
        }
        .program-detail-btn {
            padding: 12px 32px;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }
        .program-detail-btn-secondary {
            background: white;
            color: #6b7280;
            border: 1px solid #d1d5db;
        }
        .program-detail-btn-secondary:hover {
            background: #f3f4f6;
        }
        .program-detail-btn-primary {
            background: #ff6b35;
            color: white;
        }
        .program-detail-btn-primary:hover {
            background: #e55a2e;
        }
        
        @media (max-width: 768px) {
            .program-info-grid {
                grid-template-columns: 1fr;
            }
            .program-detail-footer {
                flex-direction: column;
            }
            .program-detail-btn {
                width: 100%;
            }
        }
        
        .image-detail-modal {
            background: linear-gradient(135deg, #ff6b35, #dc2626);
            padding: 20px 30px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        .image-detail-header h2 {
            margin: 0;
            font-size: 24px;
            font-weight: bold;
        }
        .image-detail-close {
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .image-detail-close:hover {
            background: rgba(255,255,255,0.5);
            transform: scale(1.1);
        }
        .image-detail-body {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .image-detail-image-container {
            max-width: 100%;
            max-height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }
        .image-detail-image-wrapper {
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            border-radius: 12px;
            overflow: hidden;
        }
        .image-detail-image {
            max-width: 100%;
            max-height: 70vh;
            object-fit: contain;
            display: block;
        }
        .image-detail-caption {
            margin-top: 20px;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
            border-left: 4px solid #ff6b35;
            max-width: 800px;
        }
        .image-detail-caption h3 {
            margin: 0 0 10px 0;
            color: #1f2937;
            font-size: 18px;
        }
        .image-detail-caption p {
            margin: 0;
            color: #6b7280;
            font-size: 14px;
            line-height: 1.8;
        }
        .image-detail-info {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .image-detail-info-item {
            background: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .image-detail-info-item svg {
            width: 20px;
            height: 20px;
            color: #ff6b35;
        }
        .image-detail-info-item span {
            font-size: 14px;
            color: #374151;
            font-weight: 500;
        }
        .selected-item {
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <header style="background: white; border-bottom: 1px solid #e5e7eb; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
        <div style="max-width: 1400px; margin: 0 auto; padding: 16px 24px; display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center; gap: 12px;">
                <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #ff6b35, #dc2626); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 18px;">
                    æ–°
                </div>
                <div>
                    <h1 style="font-size: 20px; font-weight: bold; color: #1f2937; margin: 0;">æ–°ä¸œæ–¹æŸ¥æ ¡ç³»ç»Ÿ</h1>
                    <p style="font-size: 12px; color: #6b7280; margin: 4px 0 0 0;">äºšæ´²ç•™å­¦ä¸“ä¸šæŸ¥è¯¢å¹³å°</p>
                </div>
            </div>
            <div style="display: flex; align-items: center; gap: 16px;">
                <button style="color: #4b5563; font-size: 14px; font-weight: 500; background: none; border: none; cursor: pointer;">ä½¿ç”¨æŒ‡å—</button>
                <button style="background: #ff6b35; color: white; padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 500; border: none; cursor: pointer;">ç™»å½•/æ³¨å†Œ</button>
            </div>
        </div>
    </header>

    <div style="max-width: 1400px; margin: 0 auto; padding: 24px;">
        <div style="display: grid; grid-template-columns: 1fr 300px; gap: 24px;">
            
            <!-- Middle - Results -->
            <div style="background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); min-height: 800px; display: flex; flex-direction: column;">
                
                <!-- Results Header -->
                <div style="padding: 20px; border-bottom: 1px solid #f3f4f6;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                        <div>
                            <h2 style="font-size: 18px; font-weight: bold; color: #1f2937; margin: 0;" id="resultsTitle">é«˜æ ¡æ’å</h2>
                            <p style="font-size: 14px; color: #6b7280; margin: 4px 0 0 0;" id="resultsSubtitle">å…± <span style="color: #ff6b35; font-weight: bold;">27</span> æ‰€é«˜æ ¡</p>
                        </div>
                        <div style="display: flex; align-items: center; gap: 12px;" id="sortOptions">
                            <select style="padding: 6px 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px; outline: none;">
                                <option>ç»¼åˆæ’åº</option>
                                <option>å­¦è´¹ä»ä½åˆ°é«˜</option>
                                <option>å­¦è´¹ä»é«˜åˆ°ä½</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Search Filters -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <!-- Major Search -->
                        <div style="background: #f9fafb; border-radius: 8px; padding: 12px;">
                            <h3 style="font-weight: bold; color: #1f2937; margin: 0 0 8px 0; font-size: 14px;">ä¸“ä¸šæœç´¢</h3>
                            <div class="search-box" style="display: flex; align-items: center; padding: 8px 10px; background: white; border-radius: 6px; border: 1px solid #e5e7eb;">
                                <svg width="16" height="16" fill="none" stroke="#9ca3af" stroke-width="2" viewBox="0 0 24 24" style="margin-right: 8px;">
                                    <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                                <input type="text" placeholder="è¾“å…¥ä¸“ä¸šåç§°..." style="flex: 1; border: none; outline: none; font-size: 14px;" oninput="filterMajors(this.value)">
                            </div>
                        </div>

                        <!-- Language Filter -->
                        <div style="background: #f9fafb; border-radius: 8px; padding: 12px;">
                            <h3 style="font-weight: bold; color: #1f2937; margin: 0 0 8px 0; font-size: 14px;">è¯­è¨€æ¡ä»¶</h3>
                            <div style="display: flex; gap: 8px;">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; flex: 1; padding: 8px; background: white; border: 1px solid #e5e7eb; border-radius: 6px; transition: all 0.2s;" onmouseover="this.style.borderColor='#ff6b35'" onmouseout="this.style.borderColor='#e5e7eb'" onclick="filterByCET6()">
                                    <div class="checkbox-custom" onclick="event.stopPropagation(); toggleCheckbox(this)"></div>
                                    <span style="font-size: 13px; color: #374151;">å…­çº§æˆç»©å¯ç”³</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; flex: 1; padding: 8px; background: white; border: 1px solid #e5e7eb; border-radius: 6px; transition: all 0.2s;" onmouseover="this.style.borderColor='#ff6b35'" onmouseout="this.style.borderColor='#e5e7eb'" onclick="filterByNoLanguage()">
                                    <div class="checkbox-custom" onclick="event.stopPropagation(); toggleCheckbox(this)"></div>
                                    <span style="font-size: 13px; color: #374151;">æ— éœ€è¯­è¨€å¯ç”³</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results List -->
                <div style="flex: 1;" id="resultsList">
                </div>
            </div>

            <!-- Right Sidebar -->
            <div style="display: flex; flex-direction: column; gap: 20px;">
                
                <!-- Selected Preview -->
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                    <h3 style="font-weight: bold; color: #1f2937; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                        <svg width="20" height="20" fill="none" stroke="#ff6b35" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                        </svg>
                        æ–¹æ¡ˆé¢„è§ˆ
                        <span style="margin-left: auto; font-size: 12px; background: #fff7ed; color: #c2410c; padding: 4px 8px; border-radius: 12px;" id="selectedCount">å·²é€‰ 0 é¡¹</span>
                    </h3>
                    
                    <div style="overflow-y: auto;" id="selectedList">
                        <div style="text-align: center; color: #9ca3af; padding: 40px 0; font-size: 14px;">
                            <svg width="48" height="48" fill="none" stroke="#d1d5db" stroke-width="1.5" viewBox="0 0 24 24" style="margin: 0 auto 8px auto;">
                                <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            æš‚æ— é€‰ä¸­ä¸“ä¸š<br>
                            <span style="font-size: 12px;">ç‚¹å‡»å·¦ä¾§åˆ—è¡¨é€‰æ‹©æ„Ÿå…´è¶£çš„ä¸“ä¸š</span>
                        </div>
                    </div>

                    <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #f3f4f6; display: flex; flex-direction: column; gap: 8px;">
                        <button onclick="exportToPDF()" style="width: 100%; background: #1f2937; color: white; padding: 10px; border-radius: 8px; font-size: 14px; font-weight: 500; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            å¯¼å‡º PDF
                        </button>
                        <button onclick="exportToExcel()" style="width: 100%; background: #16a34a; color: white; padding: 10px; border-radius: 8px; font-size: 14px; font-weight: 500; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            å¯¼å‡º Excel
                        </button>
                        <button onclick="exportToPNG()" style="width: 100%; border: 1px solid #d1d5db; color: #374151; padding: 10px; border-radius: 8px; font-size: 14px; font-weight: 500; background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            å¯¼å‡º PNG å›¾ç‰‡
                        </button>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div style="background: linear-gradient(135deg, #ff6b35, #dc2626); border-radius: 12px; padding: 20px; color: white; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                    <h3 style="font-weight: bold; margin-bottom: 16px;">ç”³è¯·åŠ©æ‰‹</h3>
                    <div style="display: flex; flex-direction: column; gap: 12px; font-size: 14px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="opacity: 0.9;">å¹³å‡å­¦è´¹</span>
                            <span style="font-weight: bold;">HK$380,000</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="opacity: 0.9;">é›…æ€è¦æ±‚</span>
                            <span style="font-weight: bold;">6.0-7.0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="opacity: 0.9;">ç”³è¯·æˆåŠŸç‡</span>
                            <span style="font-weight: bold;">35%</span>
                        </div>
                    </div>
                    <button style="width: 100%; margin-top: 16px; background: white; color: #ff6b35; padding: 10px; border-radius: 8px; font-size: 14px; font-weight: bold; border: none; cursor: pointer;">
                        è·å–ç”³è¯·å»ºè®®
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- School Detail Modal -->
    <div class="school-detail-overlay" id="schoolDetailOverlay" onclick="hideSchoolDetail()"></div>

    <div class="detail-modal" id="schoolDetailModal">
        <button class="close-school-detail" onclick="hideSchoolDetail()">Ã—</button>
        <div class="school-detail-header">
            <div style="width: 80px; height: 80px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); flex-shrink: 0;">
                <svg width="48" height="48" viewBox="0 0 100 100" fill="none">
                    <circle cx="50" cy="50" r="45" fill="#007bff"/>
                    <text x="50" y="65" text-anchor="middle" fill="white" font-size="24" font-weight="bold">æ¸¯å¤§</text>
                </svg>
            </div>
            <div style="flex: 1;">
                <h2 id="schoolDetailTitle">é¦™æ¸¯å¤§å­¦</h2>
                <p id="schoolDetailSubtitle">The University of Hong Kong</p>
            </div>
        </div>
        <div class="school-detail-content">
            <section>
                <h2 style="font-size: 1.8rem; border-bottom: 3px solid #007bff; padding-bottom: 10px; margin-bottom: 20px;">å­¦æ ¡ä»‹ç»</h2>
                <p class="school-intro">
                    é¦™æ¸¯å¤§å­¦ (The University of Hong Kong)ï¼Œç®€ç§°"æ¸¯å¤§ (HKU)"ï¼Œæ˜¯ä¸­å›½çš„ä¸€æ‰€å›½é™…åŒ–å…¬ç«‹ç ”ç©¶å‹å¤§å­¦ï¼Œé€šå¸¸è¢«è®¤ä¸ºæ˜¯äºšæ´²æœ€å…·åæœ›çš„å¤§å­¦ä¹‹ä¸€ï¼Œæœ‰äºšæ´²"å¸¸æ˜¥è—¤"ä¹‹ç§°ï¼Œå…¶å‰èº«ä¸ºé¦™æ¸¯è¥¿åŒ»ä¹¦é™¢ã€‚é¦™æ¸¯å¤§å­¦å¥ åŸºäº1910å¹´3æœˆ16æ—¥ï¼Œæ¬¡å¹´3æœˆ30æ—¥æ­£å¼æ³¨å†Œæˆç«‹ï¼Œæ˜¯ä¸­å›½é¦™æ¸¯å†å²æœ€æ‚ ä¹…çš„é«˜ç­‰æ•™è‚²æœºæ„ã€‚é¦™æ¸¯å¤§å­¦è‡ªåˆ›æ ¡ä»¥æ¥å§‹ç»ˆé‡‡ç”¨è‹±è¯­æ•™å­¦ï¼Œå…¶å­¦æœ¯ç ”ç©¶å¤šå¯ä¸æ¬§ç¾æ— ç¼å¯¹æ¥ã€è‰¯æ€§äº’åŠ¨ï¼Œä¹Ÿå¾—ç›Šäºæ­¤ï¼Œåœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œä»¥åŒ»å­¦ã€å•†ç§‘ã€äººæ–‡ã€æ”¿æ³•ç­‰é¢†åŸŸè§é•¿çš„é¦™æ¸¯å¤§å­¦éƒ½æ˜¯ä¸­å›½é«˜ç­‰æ•™è‚²ç•Œä¸€é¢ç‹¬ç‰¹çš„æ——å¸œï¼Œäº«èª‰äºšæ´²ä¹ƒè‡³ä¸–ç•Œã€‚é¦™æ¸¯å¤§å­¦ä¸ºç¯å¤ªå¹³æ´‹å¤§å­¦è”ç›Ÿã€æ¾è”ç›Ÿã€Universitas 21ã€ä¸­å›½å¤§å­¦æ ¡é•¿è”è°Šä¼šã€ç²¤æ¸¯æ¾³é«˜æ ¡è”ç›Ÿã€äº¬æ¸¯å¤§å­¦è”ç›Ÿã€æ²ªæ¸¯å¤§å­¦è”ç›Ÿæˆå‘˜ï¼ŒAACSBåŠEQUISåŒé‡è®¤è¯æˆå‘˜ï¼Œæ˜¯å…¨çƒç¬¬ä¸€ä¸ªç•Œå®šå‡ºSARSç—…åŸä½“çš„ç§‘ç ”å•ä½ã€‚
                </p>
            </section>

            <section style="margin-top: 30px;">
                <h2 style="font-size: 1.8rem; border-bottom: 3px solid #007bff; padding-bottom: 10px; margin-bottom: 20px;">å­¦é™¢è®¾ç½®</h2>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px;">
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">å»ºç­‘å­¦é™¢</button>
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">æ–‡å­¦é™¢</button>
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">ç»æµç®¡ç†å­¦é™¢</button>
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">ç‰™åŒ»å­¦é™¢</button>
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">æ•™è‚²å­¦é™¢</button>
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">å·¥ç¨‹å­¦é™¢</button>
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">æ³•å­¦é™¢</button>
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">æå˜‰è¯šåŒ»å­¦é™¢</button>
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">ç†å­¦é™¢</button>
                    <button style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">ç¤¾ä¼šç§‘å­¦å­¦é™¢</button>
                </div>
            </section>

            <section style="margin-top: 30px;">
                <h2 style="font-size: 1.8rem; border-bottom: 3px solid #007bff; padding-bottom: 10px; margin-bottom: 20px;">çƒ­é—¨ä¸“ä¸š</h2>
                <table class="school-info-table">
                    <thead>
                        <tr>
                            <th style="width: 20%;">ä¸“ä¸šåç§°</th>
                            <th style="width: 13%;">è¯­è¨€è¦æ±‚</th>
                            <th style="width: 15%;">æˆªæ­¢æ—¶é—´</th>
                            <th style="width: 10%;">GRE/GMAT</th>
                            <th style="width: 12%;">å­¦åˆ¶</th>
                            <th style="width: 15%;">å­¦è´¹</th>
                            <th style="width: 15%;">é¡¹ç›®è¯¦æƒ…</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </section>

            <div style="text-align: center; margin-top: 30px;">
                <button onclick="hideSchoolDetail()" style="padding: 10px 20px; background-color: #6c757d; color: white; text-decoration: none; border-radius: 5px; font-size: 1rem; cursor: pointer; border: none;">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- Program Detail Modal -->
    <div class="program-detail-overlay" id="programDetailOverlay" onclick="closeProgramDetail()"></div>
    
    <div class="program-detail-modal" id="programDetailModal">
        <div class="program-detail-content">
            <div class="program-detail-header">
                <h2 id="programSchoolName">é¦™æ¸¯å¤§å­¦</h2>
                <button class="program-detail-close" onclick="closeProgramDetail()">Ã—</button>
            </div>
            
            <div class="program-detail-body">
                <section class="program-section">
                    <h3 class="program-section-title">ä¸“ä¸šåç§°</h3>
                    <p class="program-chinese-name" id="programChineseName">ç»æµå­¦ç¡•å£«</p>
                    <p class="program-english-name" id="programEnglishName">Master of Economics</p>
                </section>
                
                <section class="program-section">
                    <h3 class="program-section-title">å®˜æ–¹é“¾æ¥</h3>
                    <a href="#" class="program-website-link" id="programWebsiteLink" target="_blank">
                        è®¿é—®å­¦æ ¡å®˜ç½‘
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="margin-left: 4px;">
                            <path d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2V8a2 2 0 00-2-2h-2M10 6a2 2 0 002 2h2a2 2 0 002-2M10 6a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                        </svg>
                    </a>
                </section>
                
                <section class="program-section">
                    <h3 class="program-section-title">ç¡•å£«é¡¹ç›®ç›¸å…³ä¿¡æ¯</h3>
                    <div class="program-info-grid">
                        <div class="program-info-item">
                            <span class="program-info-label">è¯­è¨€è¦æ±‚</span>
                            <span class="program-info-value" id="programLanguage">é›…æ€ 6.0ï¼ˆå„é¡¹ä¸ä½äº5.5ï¼‰</span>
                        </div>
                        <div class="program-info-item">
                            <span class="program-info-label">GRE/GMATè¦æ±‚</span>
                            <span class="program-info-value" id="programGRE">ä¸è¦æ±‚</span>
                        </div>
                        <div class="program-info-item">
                            <span class="program-info-label">å­¦åˆ¶</span>
                            <span class="program-info-value" id="programDuration">1å¹´å…¨æ—¥åˆ¶</span>
                        </div>
                        <div class="program-info-item">
                            <span class="program-info-label">å­¦è´¹</span>
                            <span class="program-info-value program-tuition" id="programTuition">HK$360,000</span>
                        </div>
                        <div class="program-info-item">
                            <span class="program-info-label">ç”³è¯·æˆªæ­¢</span>
                            <span class="program-info-value" id="programDeadline">2025-10-03</span>
                        </div>
                    </div>
                </section>
                
                <section class="program-section">
                    <h3 class="program-section-title">ç¡•å£«é¡¹ç›®è¯¾ç¨‹å†…å®¹</h3>
                    <div class="program-curriculum" id="programCurriculum">
                        <p>è¯¾ç¨‹è¯¦æƒ…è¯·æŸ¥çœ‹å­¦æ ¡å®˜ç½‘è·å–æœ€æ–°ä¿¡æ¯ã€‚</p>
                    </div>
                </section>
            </div>
            
            <div class="program-detail-footer">
                <button class="program-detail-btn program-detail-btn-secondary" onclick="closeProgramDetail()">å…³é—­</button>
                <button class="program-detail-btn program-detail-btn-primary" onclick="addToComparison()">åŠ å…¥å¯¹æ¯”</button>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div class="detail-modal" id="detailModal" onclick="if(event.target === this) closeModal()">
        <div class="detail-content">
            <div style="background: linear-gradient(135deg, #ff6b35, #dc2626); padding: 24px; color: white; display: flex; justify-content: space-between; align-items: start;">
                <div>
                    <h2 style="font-size: 24px; font-weight: bold; margin: 0;" id="modalTitle">ç»æµå­¦ç¡•å£«</h2>
                    <p style="margin: 4px 0 0 0; opacity: 0.9;" id="modalSubtitle">Master of Economics</p>
                </div>
                <button onclick="closeModal()" style="background: none; border: none; color: white; cursor: pointer; font-size: 24px; line-height: 1;">Ã—</button>
            </div>
            <div style="padding: 24px; max-height: 60vh; overflow-y: auto;">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px;">
                    <div style="background: #f9fafb; padding: 16px; border-radius: 8px;">
                        <span style="font-size: 12px; color: #6b7280; display: block; margin-bottom: 4px;">æ‰€å±é™¢æ ¡</span>
                        <span style="font-weight: 600; color: #1f2937;">é¦™æ¸¯å¤§å­¦ - ç»ç®¡å­¦é™¢</span>
                    </div>
                    <div style="background: #f9fafb; padding: 16px; border-radius: 8px;">
                        <span style="font-size: 12px; color: #6b7280; display: block; margin-bottom: 4px;">å­¦åˆ¶</span>
                        <span style="font-weight: 600; color: #1f2937;">1å¹´å…¨æ—¥åˆ¶ / 2å¹´å…¼è¯»åˆ¶</span>
                    </div>
                    <div style="background: #f9fafb; padding: 16px; border-radius: 8px;">
                        <span style="font-size: 12px; color: #6b7280; display: block; margin-bottom: 4px;">å­¦è´¹</span>
                        <span style="font-weight: 600; color: #ff6b35;">HK$360,000</span>
                    </div>
                    <div style="background: #f9fafb; padding: 16px; border-radius: 8px;">
                        <span style="font-size: 12px; color: #6b7280; display: block; margin-bottom: 4px;">ç”³è¯·æˆªæ­¢</span>
                        <span style="font-weight: 600; color: #1f2937;">æå‰æ‰¹ï¼š2025-07-25<br>æ­£å¼æ‰¹ï¼š2025-10-03</span>
                    </div>
                </div>

                <div style="margin-bottom: 24px;">
                    <h3 style="font-weight: bold; color: #1f2937; margin-bottom: 12px;">è¯­è¨€è¦æ±‚</h3>
                    <div style="display: flex; gap: 12px;">
                        <span style="padding: 8px 16px; background: #dbeafe; color: #1e40af; border-radius: 20px; font-size: 14px;">é›…æ€ 6.0ï¼ˆå„é¡¹ä¸ä½äº5.5ï¼‰</span>
                        <span style="padding: 8px 16px; background: #dbeafe; color: #1e40af; border-radius: 20px; font-size: 14px;">æ‰˜ç¦ 80</span>
                    </div>
                </div>

                <div style="margin-bottom: 24px;">
                    <h3 style="font-weight: bold; color: #1f2937; margin-bottom: 12px;">ä¸“ä¸šæ¦‚å†µ</h3>
                    <p style="color: #4b5563; font-size: 14px; line-height: 1.6;">
                        æ—¨åœ¨å‘å­¦ç”Ÿä»‹ç»ç»æµå­¦çš„å‰æ²¿å‘å±•ï¼Œå¹¶è®©ä»–ä»¬æŒæ¡å…ˆè¿›çš„åˆ†æå·¥å…·ã€‚è¯¾ç¨‹æä¾›ä¸‰ä¸ªä¸“ä¿®æ–¹å‘ï¼šæ•°æ®åˆ†æï¼ˆData Analysisï¼‰ã€æ”¿ç­–åˆ†æï¼ˆPolicy Analysisï¼‰æˆ–å­¦æœ¯ç†è®ºï¼ˆTheoryï¼‰ï¼ŒåŸ¹å…»å­¦ç”Ÿåœ¨ç»æµç†è®ºå’Œå®è¯åˆ†ææ–¹é¢çš„æ·±åšåŸºç¡€ã€‚
                    </p>
                </div>

                <div style="margin-bottom: 24px;">
                    <h3 style="font-weight: bold; color: #1f2937; margin-bottom: 12px;">è¯¾ç¨‹ç»“æ„</h3>
                    <div style="background: #f9fafb; padding: 16px; border-radius: 8px; color: #4b5563; font-size: 14px; line-height: 1.6;">
                        <strong>å­¦ç”Ÿé¡»å®Œæˆ10é—¨è¯¾ç¨‹ï¼ˆå…±60å­¦åˆ†ï¼‰ï¼š</strong><br><br>
                        <strong>æ ¸å¿ƒè¯¾ç¨‹ï¼ˆ3é—¨ï¼Œ18å­¦åˆ†ï¼‰ï¼š</strong><br>
                        â€¢ å¾®è§‚ç»æµå­¦ï¼ˆMicroeconomic Theoryï¼‰<br>
                        â€¢ å®è§‚ç»æµå­¦ï¼ˆMacroeconomic Theoryï¼‰<br>
                        â€¢ è®¡é‡ç»æµå­¦ï¼ˆEconometric Theoryï¼‰<br><br>
                        <strong>æ–¹å‘ä¸“ä¿®è¯¾ç¨‹ï¼ˆ4é—¨ï¼Œ24å­¦åˆ†ï¼‰</strong><br>
                        <strong>é€‰ä¿®è¯¾ç¨‹ï¼ˆ3é—¨ï¼Œ18å­¦åˆ†ï¼‰</strong>
                    </div>
                </div>

                <div>
                    <h3 style="font-weight: bold; color: #1f2937; margin-bottom: 12px;">ç”³è¯·è¦æ±‚</h3>
                    <ul style="color: #4b5563; font-size: 14px; line-height: 1.6; padding-left: 20px;">
                        <li>æŒæœ‰è®¤å¯çš„å­¦å£«å­¦ä½æˆ–åŒç­‰å­¦å†</li>
                        <li>æœ¬ç§‘æˆç»©ä¼˜å¼‚ï¼ˆé€šå¸¸è¦æ±‚3.0/4.0ä»¥ä¸Šï¼‰</li>
                        <li>è‰¯å¥½çš„æ•°å­¦æˆ–ç»Ÿè®¡å­¦åŸºç¡€</li>
                        <li>ä¸éœ€è¦GMAT/GREï¼Œä½†è‰¯å¥½æˆç»©ä¼šè¢«ä¼˜å…ˆè€ƒè™‘</li>
                        <li>å¯èƒ½æœ‰é¢è¯•</li>
                    </ul>
                </div>
            </div>
            <div style="padding: 16px 24px; border-top: 1px solid #f3f4f6; background: #f9fafb; display: flex; justify-content: flex-end; gap: 12px;">
                <button onclick="closeModal()" style="padding: 10px 20px; color: #6b7280; font-weight: 500; border: none; background: transparent; cursor: pointer;">å…³é—­</button>
                <button style="padding: 10px 20px; background: #ff6b35; color: white; border-radius: 8px; font-weight: 500; border: none; cursor: pointer;">åŠ å…¥å¯¹æ¯”</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        let selectedItems = new Set();
        let allProgramData = [];
        
        const programData = {
            1: { name: 'ç»æµå­¦ç¡•å£«', nameEn: 'Master of Economics', school: 'é¦™æ¸¯å¤§å­¦', faculty: 'ç»ç®¡å­¦é™¢', tuition: '360000', ielts: '6.0', toefl: '80', duration: '1å¹´', deadline: '2025-10-03', status: 'çƒ­æ‹›ä¸­' },
            2: { name: 'å¸‚åœºè¥é”€ç¡•å£«', nameEn: 'Master of Science in Marketing', school: 'é¦™æ¸¯å¤§å­¦', faculty: 'ç»ç®¡å­¦é™¢', tuition: '360000', ielts: '6.0', toefl: '80', duration: '1å¹´', deadline: '2025-10-03', status: 'çƒ­æ‹›ä¸­' },
            3: { name: 'ä¼šè®¡ç¡•å£«', nameEn: 'Master of Accounting', school: 'é¦™æ¸¯å¤§å­¦', faculty: 'ç»ç®¡å­¦é™¢', tuition: '360000', ielts: '6.0', toefl: '80', duration: '1å¹´', deadline: '2025-10-03', status: 'åé¢ç´§å¼ ' },
            4: { name: 'å•†ä¸šåˆ†æç†å­¦ç¡•å£«', nameEn: 'Master of Science in Business Analytics', school: 'é¦™æ¸¯å¤§å­¦', faculty: 'ç»ç®¡å­¦é™¢', tuition: '420000', ielts: '6.0', toefl: '80', duration: '1å¹´', deadline: '2025-10-03', status: 'çƒ­æ‹›ä¸­' },
            5: { name: 'é‡‘èå­¦ç¡•å£«', nameEn: 'Master of Finance', school: 'é¦™æ¸¯å¤§å­¦', faculty: 'ç»ç®¡å­¦é™¢', tuition: '462000', ielts: '6.0', toefl: '80', duration: '1å¹´', deadline: '2025-10-03', status: 'ç«äº‰æ¿€çƒˆ' },
            6: { name: 'è®¡ç®—æœºç§‘å­¦ç¡•å£«', nameEn: 'Master of Computer Science', school: 'é¦™æ¸¯ä¸­æ–‡å¤§å­¦', faculty: 'å·¥ç¨‹å­¦é™¢', tuition: '280000', ielts: '6.5', toefl: '85', duration: '1å¹´', deadline: '2025-11-15', status: 'çƒ­æ‹›ä¸­' },
            7: { name: 'é‡‘èå·¥ç¨‹ç¡•å£«', nameEn: 'MSc in Financial Engineering', school: 'é¦™æ¸¯ä¸­æ–‡å¤§å­¦', faculty: 'å•†å­¦é™¢', tuition: '380000', ielts: '6.5', toefl: '85', duration: '1å¹´', deadline: '2025-10-30', status: 'çƒ­æ‹›ä¸­' },
            8: { name: 'ç”µå­å·¥ç¨‹ç¡•å£«', nameEn: 'MSc in Electronic Engineering', school: 'é¦™æ¸¯ç§‘æŠ€å¤§å­¦', faculty: 'å·¥ç¨‹å­¦é™¢', tuition: '320000', ielts: '6.5', toefl: '85', duration: '1å¹´', deadline: '2025-12-01', status: 'åé¢ç´§å¼ ' },
            9: { name: 'æ•°æ®ç§‘å­¦ç¡•å£«', nameEn: 'MSc in Data Science', school: 'é¦™æ¸¯ç§‘æŠ€å¤§å­¦', faculty: 'ç†å­¦é™¢', tuition: '350000', ielts: '6.5', toefl: '85', duration: '1å¹´', deadline: '2025-11-30', status: 'çƒ­æ‹›ä¸­' },
            10: { name: 'å·¥å•†ç®¡ç†ç¡•å£«', nameEn: 'Master of Business Administration', school: 'æ–°åŠ å¡å›½ç«‹å¤§å­¦', faculty: 'å•†å­¦é™¢', tuition: '650000', ielts: '7.0', toefl: '100', duration: '1.5å¹´', deadline: '2025-09-30', status: 'ç«äº‰æ¿€çƒˆ' },
            11: { name: 'äººå·¥æ™ºèƒ½ç¡•å£«', nameEn: 'MSc in Artificial Intelligence', school: 'æ–°åŠ å¡å›½ç«‹å¤§å­¦', faculty: 'è®¡ç®—æœºå­¦é™¢', tuition: '450000', ielts: '6.5', toefl: '90', duration: '1å¹´', deadline: '2025-10-15', status: 'çƒ­æ‹›ä¸­' },
            12: { name: 'é‡‘èç§‘æŠ€ç¡•å£«', nameEn: 'MSc in Financial Technology', school: 'å—æ´‹ç†å·¥å¤§å­¦', faculty: 'å•†å­¦é™¢', tuition: '420000', ielts: '6.5', toefl: '90', duration: '1å¹´', deadline: '2025-10-31', status: 'åé¢ç´§å¼ ' }
        };

        const schoolRankings = {
            singapore: [
                { rank: 1, name: 'æ–°åŠ å¡å›½ç«‹å¤§å­¦', worldRank: 8, region: 'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡' },
                { rank: 2, name: 'å—æ´‹ç†å·¥å¤§å­¦', worldRank: 11, region: 'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡' },
                { rank: 3, name: 'æ–°åŠ å¡ç®¡ç†å¤§å­¦', worldRank: 545, region: 'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡' },
                { rank: 4, name: 'æ–°åŠ å¡ç§‘æŠ€è®¾è®¡å¤§å­¦', worldRank: 600, region: 'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡' },
                { rank: 5, name: 'æ–°åŠ å¡ç†å·¥å¤§å­¦', worldRank: 650, region: 'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡' },
                { rank: 6, name: 'æ–°è·ƒç¤¾ç§‘å¤§å­¦', worldRank: 700, region: 'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡' }
            ],
            hongkong: [
                { rank: 1, name: 'é¦™æ¸¯å¤§å­¦', worldRank: 17, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 2, name: 'é¦™æ¸¯ä¸­æ–‡å¤§å­¦', worldRank: 36, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 3, name: 'é¦™æ¸¯ç§‘æŠ€å¤§å­¦', worldRank: 47, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 4, name: 'é¦™æ¸¯ç†å·¥å¤§å­¦', worldRank: 57, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 5, name: 'é¦™æ¸¯åŸå¸‚å¤§å­¦', worldRank: 62, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 6, name: 'é¦™æ¸¯æµ¸ä¼šå¤§å­¦', worldRank: 295, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 7, name: 'å²­å—å¤§å­¦', worldRank: 600, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 8, name: 'é¦™æ¸¯æ•™è‚²å¤§å­¦', worldRank: 650, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 9, name: 'é¦™æ¸¯éƒ½ä¼šå¤§å­¦', worldRank: 700, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 10, name: 'é¦™æ¸¯æ ‘ä»å¤§å­¦', worldRank: 750, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 11, name: 'é¦™æ¸¯æ’ç”Ÿå¤§å­¦', worldRank: 800, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 12, name: 'é¦™æ¸¯ç æµ·å­¦é™¢', worldRank: 850, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 13, name: 'é¦™æ¸¯é«˜ç­‰æ•™è‚²ç§‘æŠ€å­¦é™¢', worldRank: 900, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 14, name: 'é¦™æ¸¯ç§‘æŠ€å¤§å­¦ï¼ˆå¹¿å·ï¼‰', worldRank: 1000, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 15, name: 'é¦™æ¸¯ä¸­æ–‡å¤§å­¦ï¼ˆæ·±åœ³ï¼‰', worldRank: 1000, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 16, name: 'é¦™æ¸¯åŸå¸‚å¤§å­¦ï¼ˆä¸œèï¼‰', worldRank: 1000, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' },
                { rank: 17, name: 'åŒ—å¸ˆé¦™æ¸¯æµ¸ä¼šå¤§å­¦', worldRank: 1000, region: 'ğŸ‡­ğŸ‡° é¦™æ¸¯' }
            ],
            macau: [
                { rank: 1, name: 'æ¾³é—¨å¤§å­¦', worldRank: 180, region: 'ğŸ‡²ğŸ‡´ æ¾³é—¨' },
                { rank: 2, name: 'æ¾³é—¨ç§‘æŠ€å¤§å­¦', worldRank: 392, region: 'ğŸ‡²ğŸ‡´ æ¾³é—¨' },
                { rank: 3, name: 'æ¾³é—¨åŸå¸‚å¤§å­¦', worldRank: 800, region: 'ğŸ‡²ğŸ‡´ æ¾³é—¨' },
                { rank: 4, name: 'æ¾³é—¨ç†å·¥å¤§å­¦', worldRank: 900, region: 'ğŸ‡²ğŸ‡´ æ¾³é—¨' }
            ]
        };

        const schoolNamesEn = {
            'æ–°åŠ å¡å›½ç«‹å¤§å­¦': 'National University of Singapore',
            'å—æ´‹ç†å·¥å¤§å­¦': 'Nanyang Technological University',
            'æ–°åŠ å¡ç®¡ç†å¤§å­¦': 'Singapore Management University',
            'æ–°åŠ å¡ç§‘æŠ€è®¾è®¡å¤§å­¦': 'Singapore University of Technology and Design',
            'æ–°åŠ å¡ç†å·¥å¤§å­¦': 'Singapore Institute of Technology',
            'æ–°è·ƒç¤¾ç§‘å¤§å­¦': 'Singapore University of Social Sciences',
            'é¦™æ¸¯å¤§å­¦': 'The University of Hong Kong',
            'é¦™æ¸¯ä¸­æ–‡å¤§å­¦': 'The Chinese University of Hong Kong',
            'é¦™æ¸¯ç§‘æŠ€å¤§å­¦': 'The Hong Kong University of Science and Technology',
            'é¦™æ¸¯ç†å·¥å¤§å­¦': 'The Hong Kong Polytechnic University',
            'é¦™æ¸¯åŸå¸‚å¤§å­¦': 'City University of Hong Kong',
            'é¦™æ¸¯æµ¸ä¼šå¤§å­¦': 'Hong Kong Baptist University',
            'å²­å—å¤§å­¦': 'Lingnan University',
            'é¦™æ¸¯æ•™è‚²å¤§å­¦': 'The Education University of Hong Kong',
            'é¦™æ¸¯éƒ½ä¼šå¤§å­¦': 'Hong Kong Metropolitan University',
            'é¦™æ¸¯æ ‘ä»å¤§å­¦': 'Hong Kong Shue Yan University',
            'é¦™æ¸¯æ’ç”Ÿå¤§å­¦': 'Hang Seng Management College',
            'é¦™æ¸¯ç æµ·å­¦é™¢': 'Chu Hai College of Higher Education',
            'é¦™æ¸¯é«˜ç­‰æ•™è‚²ç§‘æŠ€å­¦é™¢': 'Technological and Higher Education Institute of Hong Kong',
            'é¦™æ¸¯ç§‘æŠ€å¤§å­¦ï¼ˆå¹¿å·ï¼‰': 'HKUST (Guangzhou)',
            'é¦™æ¸¯ä¸­æ–‡å¤§å­¦ï¼ˆæ·±åœ³ï¼‰': 'CUHK (Shenzhen)',
            'é¦™æ¸¯åŸå¸‚å¤§å­¦ï¼ˆä¸œèï¼‰': 'CityU (Dongguan)',
            'åŒ—å¸ˆé¦™æ¸¯æµ¸ä¼šå¤§å­¦': 'Beijing Normal University - Hong Kong Baptist University',
            'æ¾³é—¨å¤§å­¦': 'University of Macau',
            'æ¾³é—¨ç§‘æŠ€å¤§å­¦': 'Macau University of Science and Technology',
            'æ¾³é—¨åŸå¸‚å¤§å­¦': 'City University of Macau',
            'æ¾³é—¨ç†å·¥å¤§å­¦': 'Macao Polytechnic University'
        };

        const schoolData = {};

        const schoolFileNameMap = {
            'é¦™æ¸¯å¤§å­¦': 'HKU',
            'é¦™æ¸¯ä¸­æ–‡å¤§å­¦': 'CUHK',
            'é¦™æ¸¯ç§‘æŠ€å¤§å­¦': 'HKUST',
            'é¦™æ¸¯ç†å·¥å¤§å­¦': 'PolyU',
            'é¦™æ¸¯åŸå¸‚å¤§å­¦': 'CityU',
            'é¦™æ¸¯æµ¸ä¼šå¤§å­¦': 'HKBU',
            'å²­å—å¤§å­¦': 'Lingnan',
            'é¦™æ¸¯æ•™è‚²å¤§å­¦': 'EdUHK',
            'é¦™æ¸¯éƒ½ä¼šå¤§å­¦': 'HKMU',
            'é¦™æ¸¯æ ‘ä»å¤§å­¦': 'SYU',
            'é¦™æ¸¯æ’ç”Ÿå¤§å­¦': 'HSUHK',
            'é¦™æ¸¯ç æµ·å­¦é™¢': 'CHC',
            'é¦™æ¸¯é«˜ç­‰æ•™è‚²ç§‘æŠ€å­¦é™¢': 'THEi',
            'é¦™æ¸¯ç§‘æŠ€å¤§å­¦ï¼ˆå¹¿å·ï¼‰': 'HKUST-GZ',
            'é¦™æ¸¯ä¸­æ–‡å¤§å­¦ï¼ˆæ·±åœ³ï¼‰': 'CUHK-SZ',
            'é¦™æ¸¯åŸå¸‚å¤§å­¦ï¼ˆä¸œèï¼‰': 'CityU-DG',
            'åŒ—å¸ˆé¦™æ¸¯æµ¸ä¼šå¤§å­¦': 'UIC',
            'æ–°åŠ å¡å›½ç«‹å¤§å­¦': 'NUS',
            'å—æ´‹ç†å·¥å¤§å­¦': 'NTU',
            'æ–°åŠ å¡ç®¡ç†å¤§å­¦': 'SMU',
            'æ–°åŠ å¡ç§‘æŠ€è®¾è®¡å¤§å­¦': 'SUTD',
            'æ–°åŠ å¡ç†å·¥å¤§å­¦': 'SIT',
            'æ–°è·ƒç¤¾ç§‘å¤§å­¦': 'SUSS',
            'æ¾³é—¨å¤§å­¦': 'UM',
            'æ¾³é—¨ç§‘æŠ€å¤§å­¦': 'MUST',
            'æ¾³é—¨åŸå¸‚å¤§å­¦': 'CityU-Macau',
            'æ¾³é—¨ç†å·¥å¤§å­¦': 'MPU'
        };

        async function loadSchoolData(schoolName) {
            const fileNameBase = schoolFileNameMap[schoolName] || schoolName;
            const fileName = './' + fileNameBase + '.json';
            console.log('Attempting to load:', fileName);
            try {
                const response = await fetch(fileName);
                console.log('Response status:', response.status);
                if (!response.ok) {
                    throw new Error('File not found');
                }
                const text = await response.text();
                console.log('Response text length:', text.length);
                const data = JSON.parse(text);
                schoolData[schoolName] = data;
                data.forEach(program => {
                    allProgramData.push({
                        id: allProgramData.length + 1,
                        school: program.uni,
                        faculty: program.fac,
                        name: program.cn,
                        nameEn: program.en,
                        ielts: program.req_ielts,
                        toefl: program.req_toefl,
                        tuition: program.fee,
                        duration: program.duration,
                        deadline: program.deadline,
                        req_academic: program.req_academic,
                        sourceFile: fileName
                    });
                });
                console.log('Data loaded successfully for:', schoolName, 'Total programs:', data.length);
                return data;
            } catch (error) {
                console.error('Error loading school data:', error);
                console.error('File name:', fileName);
                return null;
            }
        }

        async function goToSchoolDetail(schoolName) {
            document.getElementById('schoolDetailTitle').textContent = schoolName;
            document.getElementById('schoolDetailSubtitle').textContent = schoolNamesEn[schoolName] || '';
            
            const data = await loadSchoolData(schoolName);
            
            if (data) {
                renderSchoolDetail(data);
            }
            
            document.getElementById('schoolDetailModal').classList.add('active');
            document.getElementById('schoolDetailOverlay').classList.add('active');
        }

        function renderSchoolDetail(data) {
            const faculties = [...new Set(data.map(item => item.fac))];
            const facultiesContainer = document.querySelector('.school-detail-content section:nth-of-type(2) div');
            
            if (facultiesContainer) {
                facultiesContainer.innerHTML = faculties.map(fac => 
                    `<button onclick="filterByFaculty('${fac}')" style="padding: 10px 20px; border: 1px solid #ddd; background-color: #f8f9fa; cursor: pointer; border-radius: 5px; font-size: 1rem;">${fac}</button>`
                ).join('');
            }
            
            const tableBody = document.querySelector('.school-info-table tbody');
            if (tableBody) {
                tableBody.innerHTML = data.map(item => `
                    <tr>
                        <td style="font-weight: 500;">${item.cn}</td>
                        <td style="font-size: 13px;">${item.req_ielts}</td>
                        <td style="font-size: 13px; line-height: 1.6;">${item.deadline.replace(/\n/g, '<br>')}</td>
                        <td style="font-size: 13px;">ä¸è¦æ±‚</td>
                        <td style="font-size: 13px; line-height: 1.6;">${item.duration.replace(/\n/g, '<br>')}</td>
                        <td style="font-weight: 600; color: #ff6b35;">${item.fee}</td>
                        <td><a href="#" onclick="event.preventDefault(); showProgramDetailFromTable('${item.cn}', '${item.en}', '${item.uni}', '${item.fac}', '${item.req_ielts}', '${item.tuition}', '${item.deadline.split('\n')[0]}', '${item.req_academic}')" style="color: #007bff;">æŸ¥çœ‹è¯¦æƒ…</a></td>
                    </tr>
                `).join('');
            }
        }

        function filterByFaculty(faculty) {
            const tableBody = document.querySelector('.school-info-table tbody');
            if (tableBody && schoolData[document.getElementById('schoolDetailTitle').textContent]) {
                const filteredData = schoolData[document.getElementById('schoolDetailTitle').textContent].filter(item => item.fac === faculty);
                tableBody.innerHTML = filteredData.map(item => `
                    <tr>
                        <td style="font-weight: 500;">${item.cn}</td>
                        <td style="font-size: 13px;">${item.req_ielts}</td>
                        <td style="font-size: 13px; line-height: 1.6;">${item.deadline.replace(/\n/g, '<br>')}</td>
                        <td style="font-size: 13px;">ä¸è¦æ±‚</td>
                        <td style="font-size: 13px; line-height: 1.6;">${item.duration.replace(/\n/g, '<br>')}</td>
                        <td style="font-weight: 600; color: #ff6b35;">${item.fee}</td>
                        <td><a href="#" style="color: #007bff;">æŸ¥çœ‹è¯¦æƒ…</a></td>
                    </tr>
                `).join('');
            }
        }

        function selectRegion(element, region) {
            document.querySelectorAll('.region-tag').forEach(tag => {
                tag.classList.remove('active');
                tag.style.background = '#f3f4f6';
                tag.style.color = '#374151';
            });
            element.classList.add('active');
            element.style.background = '#ff6b35';
            element.style.color = 'white';
            
            if (region === 'all') {
                renderSchoolRankings();
            } else {
                renderResults(programData);
            }
        }

        function renderSchoolRankings() {
            const resultsList = document.getElementById('resultsList');
            const titleElement = document.getElementById('resultsTitle');
            const subtitleElement = document.getElementById('resultsSubtitle');
            const sortOptions = document.getElementById('sortOptions');
            
            if (titleElement) titleElement.textContent = 'é«˜æ ¡æ’å';
            if (subtitleElement) subtitleElement.innerHTML = 'å…± <span style="color: #ff6b35; font-weight: bold;">27</span> æ‰€é«˜æ ¡';
            if (sortOptions) sortOptions.style.display = 'none';

            resultsList.innerHTML = `
                <div style="padding: 30px 20px;">
                    <div style="margin-bottom: 40px;">
                        <h3 style="font-size: 20px; font-weight: bold; color: #1f2937; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">ğŸ‡¸ğŸ‡¬</span>
                            æ–°åŠ å¡é«˜æ ¡æ’å
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                            ${schoolRankings.singapore.map((school, index) => `
                                <div style="display: flex; align-items: center; padding: 16px; background: ${index === 0 ? '#fff7ed' : 'white'}; border: ${index === 0 ? '2px solid #fed7aa' : '1px solid #f3f4f6'}; border-radius: 8px; transition: all 0.2s; cursor: pointer;" onclick="goToSchoolDetail('${school.name}')">
                                    <div style="width: 40px; height: 40px; background: ${index === 0 ? '#ff6b35' : index === 1 ? '#f59e0b' : '#fbbf24'}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 18px; margin-right: 16px;">${school.rank}</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: bold; color: #1f2937; font-size: 16px; margin-bottom: 4px;">${school.name}</div>
                                        <div style="font-size: 13px; color: #6b7280;">${school.region} Â· ä¸–ç•Œæ’å: <span style="color: #ff6b35; font-weight: bold;">#${school.worldRank}</span></div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div style="margin-bottom: 40px;">
                        <h3 style="font-size: 20px; font-weight: bold; color: #1f2937; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">ğŸ‡­ğŸ‡°</span>
                            é¦™æ¸¯é«˜æ ¡æ’å
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                            ${schoolRankings.hongkong.map((school, index) => `
                                <div style="display: flex; align-items: center; padding: 16px; background: ${index === 0 ? '#fff7ed' : 'white'}; border: ${index === 0 ? '2px solid #fed7aa' : '1px solid #f3f4f6'}; border-radius: 8px; transition: all 0.2s; cursor: pointer;" onclick="goToSchoolDetail('${school.name}')">
                                    <div style="width: 40px; height: 40px; background: ${index === 0 ? '#ff6b35' : index === 1 ? '#f59e0b' : index === 2 ? '#fbbf24' : '#d1d5db'}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 18px; margin-right: 16px;">${school.rank}</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: bold; color: #1f2937; font-size: 16px; margin-bottom: 4px;">${school.name}</div>
                                        <div style="font-size: 13px; color: #6b7280;">${school.region} Â· ä¸–ç•Œæ’å: <span style="color: #ff6b35; font-weight: bold;">#${school.worldRank}</span></div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div>
                        <h3 style="font-size: 20px; font-weight: bold; color: #1f2937; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">ğŸ‡²ğŸ‡´</span>
                            æ¾³é—¨é«˜æ ¡æ’å
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                            ${schoolRankings.macau.map((school, index) => `
                                <div style="display: flex; align-items: center; padding: 16px; background: ${index === 0 ? '#fff7ed' : 'white'}; border: ${index === 0 ? '2px solid #fed7aa' : '1px solid #f3f4f6'}; border-radius: 8px; transition: all 0.2s; cursor: pointer;" onclick="goToSchoolDetail('${school.name}')">
                                    <div style="width: 40px; height: 40px; background: ${index === 0 ? '#ff6b35' : index === 1 ? '#f59e0b' : '#d1d5db'}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 18px; margin-right: 16px;">${school.rank}</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: bold; color: #1f2937; font-size: 16px; margin-bottom: 4px;">${school.name}</div>
                                        <div style="font-size: 13px; color: #6b7280;">${school.region} Â· ä¸–ç•Œæ’å: <span style="color: #ff6b35; font-weight: bold;">#${school.worldRank}</span></div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function toggleCheckbox(element) {
            element.classList.toggle('checked');
        }

        function toggleProgramSelection(element, id) {
            element.classList.toggle('checked');
            if (element.classList.contains('checked')) {
                selectedItems.add(id);
            } else {
                selectedItems.delete(id);
            }
            updateSelectedList();
        }

        function showProgramDetail(id) {
            const item = allProgramData.find(p => p.id === id);
            if (item) {
                document.getElementById('programSchoolName').textContent = item.school;
                document.getElementById('programChineseName').textContent = item.name;
                document.getElementById('programEnglishName').textContent = item.nameEn;
                document.getElementById('programLanguage').textContent = item.ielts;
                document.getElementById('programGRE').textContent = 'ä¸è¦æ±‚';
                document.getElementById('programDuration').textContent = item.duration.replace(/\n/g, ' ');
                document.getElementById('programTuition').textContent = item.tuition;
                document.getElementById('programDeadline').textContent = item.deadline.split('\n')[0];
                document.getElementById('programWebsiteLink').href = '#';
                document.getElementById('programCurriculum').innerHTML = `<p><strong>å­¦æœ¯è¦æ±‚ï¼š</strong>${item.req_academic || 'è¯·æŸ¥çœ‹å­¦æ ¡å®˜ç½‘è·å–æœ€æ–°ä¿¡æ¯ã€‚'}</p>`;
                
                document.getElementById('programDetailOverlay').classList.add('active');
                document.getElementById('programDetailModal').classList.add('active');
            }
        }

        function showProgramDetailFromTable(cnName, enName, schoolName, faculty, ielts, tuition, deadline, academic) {
            document.getElementById('programSchoolName').textContent = schoolName;
            document.getElementById('programChineseName').textContent = cnName;
            document.getElementById('programEnglishName').textContent = enName;
            document.getElementById('programLanguage').textContent = ielts;
            document.getElementById('programGRE').textContent = 'ä¸è¦æ±‚';
            document.getElementById('programDuration').textContent = 'è¯·æŸ¥çœ‹å®˜ç½‘';
            document.getElementById('programTuition').textContent = tuition;
            document.getElementById('programDeadline').textContent = deadline;
            document.getElementById('programWebsiteLink').href = '#';
            document.getElementById('programCurriculum').innerHTML = `<p><strong>å­¦æœ¯è¦æ±‚ï¼š</strong>${academic || 'è¯·æŸ¥çœ‹å­¦æ ¡å®˜ç½‘è·å–æœ€æ–°ä¿¡æ¯ã€‚'}</p>`;
            
            document.getElementById('programDetailOverlay').classList.add('active');
            document.getElementById('programDetailModal').classList.add('active');
        }

        function closeProgramDetail() {
            document.getElementById('programDetailOverlay').classList.remove('active');
            document.getElementById('programDetailModal').classList.remove('active');
        }

        function hideSchoolDetail() {
            document.getElementById('schoolDetailOverlay').classList.remove('active');
            document.getElementById('schoolDetailModal').classList.remove('active');
        }

        function closeModal() {
            document.getElementById('detailModal').classList.remove('active');
        }

        function addToComparison() {
            alert('å·²æ·»åŠ åˆ°å¯¹æ¯”åˆ—è¡¨');
            closeProgramDetail();
        }

        function filterByCET6() {
            const filteredData = allProgramData.filter(item => {
                const ielts = item.ielts;
                const toefl = item.toefl;
                return ielts.includes('6.0') || toefl.includes('80') || 
                       ielts.includes('ä¸å¼ºåˆ¶') || toefl.includes('ä¸å¼ºåˆ¶');
            });
            renderProgramResults(filteredData, 'å…­çº§æˆç»©å¯ç”³', `æ‰¾åˆ° ${filteredData.length} ä¸ªå¯ç”³è¯·é¡¹ç›®`);
        }

        function filterByNoLanguage() {
            const filteredData = allProgramData.filter(item => {
                const ielts = item.ielts;
                const toefl = item.toefl;
                return ielts.includes('ä¸å¼ºåˆ¶') || toefl.includes('ä¸å¼ºåˆ¶') ||
                       ielts.includes('ä¸è¦æ±‚') || toefl.includes('ä¸è¦æ±‚');
            });
            renderProgramResults(filteredData, 'æ— éœ€è¯­è¨€å¯ç”³', `æ‰¾åˆ° ${filteredData.length} ä¸ªå¯ç”³è¯·é¡¹ç›®`);
        }

        function toggleSelection(element, id) {
            element.classList.toggle('checked');
            if (element.classList.contains('checked')) {
                selectedItems.add(id);
            } else {
                selectedItems.delete(id);
            }
            updateSelectedList();
        }

        function filterSchools(keyword) {
            const resultsList = document.getElementById('resultsList');
            const countElement = document.querySelector('#resultsList').parentElement.querySelector('p span');
            
            if (!keyword || keyword.trim() === '') {
                renderSchoolRankings();
                return;
            }

            const filteredData = {};
            Object.keys(programData).forEach(id => {
                const item = programData[id];
                if (item.school.includes(keyword) || item.name.includes(keyword)) {
                    filteredData[id] = item;
                }
            });

            renderResults(filteredData);
        }

        function renderProgramResults(data, title, subtitle) {
            const resultsList = document.getElementById('resultsList');
            const titleElement = document.getElementById('resultsTitle');
            const subtitleElement = document.getElementById('resultsSubtitle');
            
            if (titleElement) titleElement.textContent = title;
            if (subtitleElement) subtitleElement.innerHTML = subtitle;

            if (data.length === 0) {
                resultsList.innerHTML = `
                    <div style="padding: 60px 20px; text-align: center; color: #9ca3af;">
                        <svg width="64" height="64" fill="none" stroke="#d1d5db" stroke-width="1.5" viewBox="0 0 24 24" style="margin: 0 auto 16px auto;">
                            <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <p style="font-size: 16px; margin-bottom: 8px;">æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</p>
                        <p style="font-size: 14px;">è¯·å°è¯•å…¶ä»–æœç´¢å…³é”®è¯</p>
                    </div>
                `;
                return;
            }

            resultsList.innerHTML = data.map(item => {
                const isSelected = selectedItems.has(item.id);
                return `
                    <div class="result-item" style="padding: 20px; border-bottom: 1px solid #f3f4f6;">
                        <div style="display: flex; align-items: start; justify-content: space-between; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div class="checkbox-custom ${isSelected ? 'checked' : ''}" onclick="toggleProgramSelection(this, ${item.id})"></div>
                                <div>
                                    <h3 style="font-weight: bold; color: #1f2937; font-size: 16px; margin: 0;">${item.name}</h3>
                                    <p style="font-size: 13px; color: #6b7280; margin: 4px 0 0 0; font-style: italic;">${item.nameEn}</p>
                                </div>
                            </div>
                            <span style="padding: 4px 12px; background: #dbeafe; color: #1e40af; border-radius: 20px; font-size: 12px; font-weight: 500;">${item.faculty}</span>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1.5fr 1fr 1.2fr 0.8fr; gap: 16px; margin-bottom: 12px; margin-left: 32px;">
                            <div>
                                <span style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 2px;">é™¢æ ¡</span>
                                <span style="font-size: 14px; color: #374151; font-weight: 500;">${item.school}</span>
                            </div>
                            <div>
                                <span style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 2px;">å­¦åˆ¶</span>
                                <span style="font-size: 14px; color: #374151; font-weight: 500;">${item.duration.replace(/\n/g, ' ')}</span>
                            </div>
                            <div>
                                <span style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 2px;">å­¦è´¹</span>
                                <span style="font-size: 14px; color: #ff6b35; font-weight: bold;">${item.tuition}</span>
                            </div>
                            <div>
                                <span style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 2px;">è¯­è¨€è¦æ±‚</span>
                                <span style="font-size: 13px; color: #374151; font-weight: 500; line-height: 1.4;">${item.ielts}</span>
                            </div>
                        </div>

                        <div style="display: flex; align-items: center; justify-content: space-between; margin-left: 32px;">
                            <div style="display: flex; gap: 8px;">
                                <span style="padding: 4px 8px; background: #f3f4f6; color: #4b5563; border-radius: 4px; font-size: 12px;">ç”³è¯·æˆªæ­¢ï¼š${item.deadline.split('\n')[0]}</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="showProgramDetail(${item.id})" style="color: #ff6b35; font-size: 14px; font-weight: 500; padding: 6px 12px; border-radius: 6px; border: none; background: transparent; cursor: pointer;">æŸ¥çœ‹è¯¦æƒ…</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterMajors(keyword) {
            const resultsList = document.getElementById('resultsList');
            const titleElement = document.getElementById('resultsTitle');
            const subtitleElement = document.getElementById('resultsSubtitle');
            const sortOptions = document.getElementById('sortOptions');
            
            if (titleElement) titleElement.textContent = 'ä¸“ä¸šæœç´¢ç»“æœ';
            if (sortOptions) sortOptions.style.display = 'flex';
            
            if (!keyword || keyword.trim() === '') {
                renderSchoolRankings();
                return;
            }

            const filteredData = allProgramData.filter(item => {
                const keywordLower = keyword.toLowerCase();
                return item.name.toLowerCase().includes(keywordLower) || 
                       item.nameEn.toLowerCase().includes(keywordLower) ||
                       item.school.toLowerCase().includes(keywordLower) ||
                       item.faculty.toLowerCase().includes(keywordLower);
            });

            renderProgramResults(filteredData, 'ä¸“ä¸šæœç´¢ç»“æœ', `æ‰¾åˆ° ${filteredData.length} ä¸ªç›¸å…³ä¸“ä¸š`);
        }

        function renderResults(data) {
            const resultsList = document.getElementById('resultsList');
            const countElement = document.querySelector('#resultsList').parentElement.querySelector('p span');
            const count = Object.keys(data).length;
            
            if (countElement) {
                countElement.textContent = count;
            }

            if (count === 0) {
                resultsList.innerHTML = `
                    <div style="padding: 60px 20px; text-align: center; color: #9ca3af;">
                        <svg width="64" height="64" fill="none" stroke="#d1d5db" stroke-width="1.5" viewBox="0 0 24 24" style="margin: 0 auto 16px auto;">
                            <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <p style="font-size: 16px; margin-bottom: 8px;">æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</p>
                        <p style="font-size: 14px;">è¯·å°è¯•å…¶ä»–æœç´¢å…³é”®è¯</p>
                    </div>
                `;
                return;
            }

            resultsList.innerHTML = Object.keys(data).map(id => {
                const item = data[id];
                
                return `
                    <div class="result-item" style="padding: 20px; border-bottom: 1px solid #f3f4f6;">
                        <div style="display: flex; align-items: start; justify-content: space-between; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div class="checkbox-custom" onclick="toggleSelection(this, ${id})"></div>
                                <div>
                                    <h3 style="font-weight: bold; color: #1f2937; font-size: 16px; margin: 0;">${item.name}</h3>
                                    <p style="font-size: 13px; color: #6b7280; margin: 4px 0 0 0; font-style: italic;">${item.nameEn}</p>
                                </div>
                            </div>
                            <span style="padding: 4px 12px; background: #dbeafe; color: #1e40af; border-radius: 20px; font-size: 12px; font-weight: 500;">${item.faculty}</span>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 12px; margin-left: 32px;">
                            <div>
                                <span style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 2px;">é™¢æ ¡</span>
                                <span style="font-size: 14px; color: #374151; font-weight: 500;">${item.school}</span>
                            </div>
                            <div>
                                <span style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 2px;">å­¦åˆ¶</span>
                                <span style="font-size: 14px; color: #374151; font-weight: 500;">${item.duration}</span>
                            </div>
                            <div>
                                <span style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 2px;">å­¦è´¹</span>
                                <span style="font-size: 14px; color: #ff6b35; font-weight: bold;">HK$${parseInt(item.tuition).toLocaleString()}</span>
                            </div>
                            <div>
                                <span style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 2px;">è¯­è¨€è¦æ±‚</span>
                                <span style="font-size: 14px; color: #374151; font-weight: 500;">é›…æ€${item.ielts}/æ‰˜ç¦${item.toefl}</span>
                            </div>
                        </div>

                        <div style="display: flex; align-items: center; justify-content: space-between; margin-left: 32px;">
                            <div style="display: flex; gap: 8px;">
                                <span style="padding: 4px 8px; background: #f3f4f6; color: #4b5563; border-radius: 4px; font-size: 12px;">ç”³è¯·æˆªæ­¢ï¼š${item.deadline}</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="showDetail(${id})" style="color: #ff6b35; font-size: 14px; font-weight: 500; padding: 6px 12px; border-radius: 6px; border: none; background: transparent; cursor: pointer;">æŸ¥çœ‹è¯¦æƒ…</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateSelectedList() {
            const container = document.getElementById('selectedList');
            const count = document.getElementById('selectedCount');
            
            count.textContent = `å·²é€‰ ${selectedItems.size} é¡¹`;
            
            if (selectedItems.size === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: #9ca3af; padding: 40px 0; font-size: 14px;">
                        <svg width="48" height="48" fill="none" stroke="#d1d5db" stroke-width="1.5" viewBox="0 0 24 24" style="margin: 0 auto 8px auto;">
                            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        æš‚æ— é€‰ä¸­ä¸“ä¸š<br>
                        <span style="font-size: 12px;">ç‚¹å‡»å·¦ä¾§åˆ—è¡¨é€‰æ‹©æ„Ÿå…´è¶£çš„ä¸“ä¸š</span>
                    </div>
                `;
                return;
            }

            container.innerHTML = Array.from(selectedItems).map(id => {
                const item = allProgramData.find(p => p.id === id);
                if (!item) return '';
                return `
                    <div class="selected-item" style="background: #fff7ed; border: 1px solid #fed7aa; border-radius: 8px; padding: 12px; margin-bottom: 8px; display: flex; align-items: center; justify-content: space-between;">
                        <div style="flex: 1; min-width: 0;">
                            <div style="font-weight: 500; color: #1f2937; font-size: 14px; margin-bottom: 2px;">${item.name}</div>
                            <div style="font-size: 12px; color: #6b7280;">${item.school} Â· ${item.faculty}</div>
                        </div>
                        <button onclick="removeProgramSelection(${id})" style="color: #9ca3af; background: none; border: none; cursor: pointer; padding: 4px; margin-left: 8px;" title="åˆ é™¤">
                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                `;
            }).join('');
        }

        function removeProgramSelection(id) {
            selectedItems.delete(id);
            const checkboxes = document.querySelectorAll('.checkbox-custom');
            checkboxes.forEach(cb => {
                const onclickAttr = cb.getAttribute('onclick');
                if (onclickAttr && onclickAttr.includes(`toggleProgramSelection(this, ${id})`)) {
                    cb.classList.remove('checked');
                }
            });
            updateSelectedList();
        }

        function removeSelection(id) {
            selectedItems.delete(id);
            const checkboxes = document.querySelectorAll('.checkbox-custom');
            checkboxes.forEach((cb, index) => {
                if (cb.getAttribute('onclick') && cb.getAttribute('onclick').includes(`toggleSelection(this, ${id})`)) {
                    cb.classList.remove('checked');
                }
            });
            updateSelectedList();
        }

        function showDetail(id) {
            const item = programData[id];
            if (item) {
                document.getElementById('modalTitle').textContent = item.name;
                document.getElementById('modalSubtitle').textContent = item.nameEn;
            }
            document.getElementById('detailModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('detailModal').classList.remove('active');
        }

        function exportToPDF() {
            if (selectedItems.size === 0) {
                alert('è¯·å…ˆé€‰æ‹©è‡³å°‘ä¸€ä¸ªä¸“ä¸š');
                return;
            }
            alert('æ­£åœ¨ç”ŸæˆPDFæ–‡ä»¶...');
        }

        function exportToExcel() {
            if (selectedItems.size === 0) {
                alert('è¯·å…ˆé€‰æ‹©è‡³å°‘ä¸€ä¸ªä¸“ä¸š');
                return;
            }

            const data = Array.from(selectedItems).map(id => {
                const item = allProgramData.find(p => p.id === id);
                if (!item) return null;
                return {
                    'ä¸“ä¸šåç§°ï¼ˆä¸­æ–‡ï¼‰': item.name,
                    'ä¸“ä¸šåç§°ï¼ˆè‹±æ–‡ï¼‰': item.nameEn,
                    'é™¢æ ¡': item.school,
                    'å­¦é™¢': item.faculty,
                    'å­¦åˆ¶': item.duration.replace(/\n/g, ' '),
                    'å­¦è´¹': item.tuition,
                    'é›…æ€è¦æ±‚': item.ielts,
                    'æ‰˜ç¦è¦æ±‚': item.toefl,
                    'ç”³è¯·æˆªæ­¢': item.deadline.split('\n')[0]
                };
            }).filter(item => item !== null);

            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "é€‰ä¸­çš„ä¸“ä¸š");
            
            const now = new Date().toLocaleDateString();
            XLSX.writeFile(wb, `æ–°ä¸œæ–¹æŸ¥æ ¡æ–¹æ¡ˆ_${now}.xlsx`);
        }

        function exportToPNG() {
            if (selectedItems.size === 0) {
                alert('è¯·å…ˆé€‰æ‹©è‡³å°‘ä¸€ä¸ªä¸“ä¸š');
                return;
            }

            const selectedData = Array.from(selectedItems).map(id => allProgramData.find(p => p.id === id)).filter(item => item !== null);
            
            if (selectedData.length === 0) {
                alert('æ²¡æœ‰æœ‰æ•ˆçš„ä¸“ä¸šæ•°æ®');
                return;
            }

            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            const padding = 60;
            const headerHeight = 100;
            const itemHeight = 80;
            const watermarkHeight = 40;
            const footerHeight = 50;
            
            const totalHeight = padding + headerHeight + (selectedData.length * itemHeight) + watermarkHeight + footerHeight;
            const width = 1000;
            
            canvas.width = width * 2;
            canvas.height = totalHeight * 2;
            ctx.scale(2, 2);
            
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, width, totalHeight);
            
            ctx.fillStyle = '#ff6b35';
            ctx.fillRect(0, 0, width, headerHeight);
            
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 28px "Noto Sans SC", "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('æ–°ä¸œæ–¹æŸ¥æ ¡ç³»ç»Ÿ - é€‰æ ¡æ–¹æ¡ˆ', width / 2, headerHeight / 2 + 15);
            
            let y = padding + headerHeight;
            
            selectedData.forEach((item, index) => {
                const itemY = y + index * itemHeight;
                
                ctx.fillStyle = '#f9fafb';
                ctx.fillRect(0, itemY, width, itemHeight);
                
                ctx.strokeStyle = '#e5e7eb';
                ctx.lineWidth = 1;
                ctx.strokeRect(0, itemY, width, itemHeight);
                
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'left';
                ctx.textBaseline = 'top';
                
                const col1X = 20;
                const col2X = 220;
                const col3X = 450;
                const col4X = 680;
                const col5X = 820;
                const labelY = itemY + 15;
                const valueY = itemY + 45;
                
                ctx.fillText('å­¦æ ¡åç§°ï¼š', col1X, labelY);
                ctx.fillStyle = '#374151';
                ctx.font = '16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(item.school || '-', col1X + 100, valueY);
                
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('å­¦é™¢åç§°ï¼š', col2X, labelY);
                ctx.fillStyle = '#374151';
                ctx.font = '16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(item.faculty || '-', col2X + 100, valueY);
                
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('ä¸“ä¸šåç§°ä¸­æ–‡ï¼š', col3X, labelY);
                ctx.fillStyle = '#374151';
                ctx.font = '16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(item.name || '-', col3X + 120, valueY);
                
                ctx.fillStyle = '#1f2937';
                ctx.font = '14px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('ä¸“ä¸šåç§°è‹±æ–‡ï¼š', col4X, labelY);
                ctx.fillStyle = '#6b7280';
                ctx.font = 'italic 14px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(item.nameEn || '-', col4X + 120, valueY);
                
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('è¯­è¨€è¦æ±‚ï¼š', col5X, labelY);
                ctx.fillStyle = '#374151';
                ctx.font = '14px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(item.ielts || '-', col5X + 100, valueY);
                
                const nextRowY = valueY + 25;
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('æˆªæ­¢æ—¶é—´ï¼š', col1X, nextRowY);
                ctx.fillStyle = '#374151';
                ctx.font = '14px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(item.deadline ? item.deadline.split('\n')[0] : '-', col1X + 100, nextRowY);
                
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('GRE/GMATï¼š', col2X, nextRowY);
                ctx.fillStyle = '#374151';
                ctx.font = '14px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('ä¸è¦æ±‚', col2X + 100, nextRowY);
                
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('å­¦åˆ¶ï¼š', col3X, nextRowY);
                ctx.fillStyle = '#374151';
                ctx.font = '14px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(item.duration ? item.duration.replace(/\n/g, ' ') : '-', col3X + 100, nextRowY);
                
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 16px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText('å­¦è´¹ï¼š', col4X, nextRowY);
                ctx.fillStyle = '#ff6b35';
                ctx.font = 'bold 14px "Noto Sans SC", "Microsoft YaHei", sans-serif';
                ctx.fillText(item.tuition || '-', col4X + 100, nextRowY);
            });
            
            const watermarkY = padding + headerHeight + (selectedData.length * itemHeight) + 10;
            
            ctx.save();
            ctx.fillStyle = 'rgba(144, 238, 144, 0.3)';
            ctx.font = 'bold 48px "Noto Sans SC", "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('é‡åº†æ–°ä¸œæ–¹å‰é€”å‡ºå›½', width / 2, watermarkY + watermarkHeight / 2);
            ctx.restore();
            
            const footerY = padding + headerHeight + (selectedData.length * itemHeight) + watermarkHeight + 15;
            ctx.fillStyle = '#f3f4f6';
            ctx.font = '12px "Noto Sans SC", "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(`å…± ${selectedData.length} ä¸ªä¸“ä¸š`, width / 2, footerY);
            
            const link = document.createElement('a');
            link.download = `æ–°ä¸œæ–¹æŸ¥æ ¡æ–¹æ¡ˆ_${new Date().toLocaleDateString()}.png`;
            link.href = canvas.toDataURL('image/png', 1.0);
            link.click();
        }

        window.onload = async function() {
            renderSchoolRankings();
            
            const allSchools = Object.keys(schoolFileNameMap);
            console.log('Loading school data for:', allSchools.length, 'schools');
            
            for (const schoolName of allSchools) {
                await loadSchoolData(schoolName);
            }
            
            console.log('All school data loaded. Total programs:', allProgramData.length);
        };
    </script>
</body>
</html>